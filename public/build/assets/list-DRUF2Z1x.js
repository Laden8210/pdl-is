import{j as e,K as w,m as b,r as f,L as R,S as O}from"./app-C1edxtTp.js";import{D as C,g as S,a as A,b as D,c as k,d as F,e as U,f as _,A as G}from"./app-layout-BllnXnPm.js";import{D as J}from"./data-table-L9tttZz6.js";import{c as I,B as c}from"./button-DrzaVBtD.js";import{I as m,C as Q}from"./input-CvEaa6Sx.js";import{L as l}from"./label-BnBrlq29.js";import{A as p,b as N,a as g}from"./alert-DRWOZzF4.js";import{A as W}from"./archive-Dck-NsHR.js";import{S as q,a as P,b as L,c as E,d as v}from"./select-CrdmFyDT.js";import{E as M}from"./eye-off-B1S6_kqF.js";import{E as z}from"./eye-DTBbKAYB.js";import{L as X}from"./loader-circle-bXXzs7TG.js";import"./index-W7eYi-Gp.js";import"./users-BkaoQLnE.js";import"./user-DCPe4-sj.js";import"./scale-jlxygnyf.js";import"./table-BZK2ALiX.js";import"./index-uHaqmIww.js";import"./index-B77BIdjF.js";import"./index-D-fkcTgw.js";import"./index-ByaXkLAF.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Z=I("Key",Y);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],se=I("Pencil",ee);function ae({page:a,totalPages:t,onPageChange:h}){if(t<=1)return null;const d=Array.from({length:t},(n,r)=>r+1);return e.jsxs("div",{className:"flex flex-wrap justify-center items-center gap-2 mt-4",children:[e.jsx(c,{variant:"outline",size:"sm",onClick:()=>h(a-1),disabled:a===1,children:"Previous"}),d.map(n=>e.jsx(c,{variant:n===a?"default":"outline",size:"sm",onClick:()=>h(n),children:n},n)),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>h(a+1),disabled:a===t,children:"Next"})]})}function re({user:a}){const{props:t}=w(),h=t.success,{delete:d,processing:n,errors:r}=b({}),i=u=>{u.preventDefault(),d(route("user-management.destroy",a.id),{preserveScroll:!0,onSuccess:()=>{}})};return e.jsxs(C,{children:[e.jsx(S,{asChild:!0,children:e.jsxs(c,{onSelect:u=>u.preventDefault(),className:" hover:bg-red-400",variant:"outline",children:[e.jsx(W,{}),"Archive"]})}),e.jsx(A,{className:"sm:max-w-[425px]",children:e.jsxs("form",{id:"delete-user-form",onSubmit:i,children:[e.jsxs(D,{children:[e.jsx(k,{children:"Delete User"}),e.jsxs(F,{children:["Are you sure you want to archive ",a.fname," ",a.lname,"?"]})]}),Object.keys(r).length>0&&e.jsxs(p,{variant:"destructive",className:"mt-4 mb-4",children:[e.jsx(N,{children:"Unable to process request"}),e.jsx(g,{children:Object.values(r).map((u,x)=>e.jsx("ul",{className:"list-inside list-disc text-sm",children:e.jsx("li",{children:u})},x))})]}),h&&e.jsxs(p,{variant:"default",className:"mb-4",children:[e.jsx(N,{children:"Success"}),e.jsx(g,{children:h})]}),e.jsx("div",{className:"py-4",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"This action cannot be undone. This will permanently delete the user account."})}),e.jsxs(U,{children:[e.jsx(_,{asChild:!0,children:e.jsx(c,{variant:"secondary",children:"Cancel"})}),e.jsx(c,{type:"submit",form:"delete-user-form",variant:"destructive",disabled:n,children:n?"Deleting...":"Delete User"})]})]})})]})}function ne({user:a}){const t=f.useRef(null),{props:h}=w(),d=h.success,{data:n,setData:r,put:i,processing:u,errors:x}=b({fname:a.fname,mname:a.mname||"",lname:a.lname,contactnum:a.contactnum,avatar:null,username:a.username,password:"",position:a.position,agency:a.agency});f.useEffect(()=>{r({fname:a.fname,mname:a.mname||"",lname:a.lname,contactnum:a.contactnum,avatar:null,username:a.username,password:"",position:a.position,agency:a.agency})},[a]);const y=s=>{s.preventDefault(),i(route("user-management.update",a.id),{preserveScroll:!0,onSuccess:()=>{r("password","")}})};return e.jsxs(C,{children:[e.jsx(R,{title:"Edit User"}),e.jsx(S,{asChild:!0,children:e.jsxs(c,{variant:"outline",className:"text-start",children:[e.jsx(se,{}),"Edit"]})}),e.jsx(A,{className:"sm:max-w-3xl",children:e.jsxs("form",{id:"edit-user-form",onSubmit:y,children:[e.jsxs(D,{children:[e.jsx(k,{children:"Edit User"}),e.jsx(F,{children:"Update the user details below."})]}),Object.keys(x).length>0&&e.jsxs(p,{variant:"destructive",className:"mt-4 mb-4",children:[e.jsx(N,{children:"Unable to process request"}),e.jsx(g,{children:Object.values(x).map((s,o)=>e.jsx("ul",{className:"list-inside list-disc text-sm",children:e.jsx("li",{children:s})},o))})]}),d&&e.jsxs(p,{variant:"default",className:"mb-4",children:[e.jsx(N,{children:"Success"}),e.jsx(g,{children:d})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 py-2",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx(l,{htmlFor:"firstName",children:"First Name"}),e.jsx(m,{id:"fname",name:"fname",value:n.fname,onChange:s=>r("fname",s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"middleName",children:"Middle Name"}),e.jsx(m,{id:"mname",name:"mname",value:n.mname,onChange:s=>r("mname",s.target.value)})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(l,{htmlFor:"lastName",children:"Last Name"}),e.jsx(m,{id:"lname",name:"lname",value:n.lname,onChange:s=>r("lname",s.target.value),required:!0})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(l,{htmlFor:"contactnum",children:"Contact Number"}),e.jsx(m,{id:"contactnum",name:"contactnum",value:n.contactnum,onChange:s=>r("contactnum",s.target.value),required:!0})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(l,{htmlFor:"avatar",children:"Avatar"}),e.jsxs("div",{className:"flex items-center gap-4",children:[a.avatar&&e.jsx("img",{src:`/storage/${a.avatar}`,alt:"Current avatar",className:"h-12 w-12 rounded-full object-cover"}),e.jsx(m,{id:"avatar",name:"avatar",type:"file",ref:t,onChange:s=>{var o;return r("avatar",((o=s.target.files)==null?void 0:o[0])??null)},accept:"image/*"})]})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(l,{htmlFor:"username",children:"Username"}),e.jsx(m,{id:"username",name:"username",value:n.username,onChange:s=>r("username",s.target.value),required:!0})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(l,{htmlFor:"password",children:"Password (leave blank to keep current)"}),e.jsx(m,{id:"password",name:"password",type:"password",value:n.password,onChange:s=>r("password",s.target.value),placeholder:"Leave blank to keep current password"})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(l,{htmlFor:"userType",children:"User Type"}),e.jsxs(q,{value:n.position,onValueChange:s=>r("position",s),required:!0,children:[e.jsx(P,{children:e.jsx(L,{placeholder:"Select user type"})}),e.jsxs(E,{children:[e.jsx(v,{value:"law-enforcement",children:"Law Enforcement"}),e.jsx(v,{value:"admin",children:"Administrator"}),e.jsx(v,{value:"record-officer",children:"Records Officer"})]})]})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(l,{htmlFor:"agency",children:"Agency"}),e.jsx(m,{id:"agency",name:"agency",value:n.agency,onChange:s=>r("agency",s.target.value),required:!0})]})]}),e.jsxs(U,{children:[e.jsx(_,{asChild:!0,children:e.jsx(c,{variant:"secondary",children:"Cancel"})}),e.jsx(c,{type:"submit",form:"edit-user-form",className:"bg-blue-500 hover:bg-blue-600",disabled:u,children:u?"Updating...":"Update User"})]})]})})]})}function te({user:a}){const[t,h]=f.useState(!1),[d,n]=f.useState(!1),[r,i]=f.useState(!1),{data:u,setData:x,post:y,processing:s,errors:o,reset:T}=b({password:"",password_confirmation:""}),V=()=>{y(route("user-management.reset-password",{id:a.id}),{onSuccess:()=>{setTimeout(()=>{T()},1500)}})},B=j=>{h(j),j||T()},{props:$}=w(),K=$.success;return e.jsxs(C,{open:t,onOpenChange:B,children:[e.jsx(S,{asChild:!0,children:e.jsxs(c,{variant:"outline",size:"sm",className:"h-8 gap-1",children:[e.jsx(Z,{className:"h-3.5 w-3.5"}),"Reset Password"]})}),e.jsxs(A,{className:"sm:max-w-[425px]",children:[e.jsxs(D,{children:[e.jsx(k,{children:"Reset Password"}),e.jsxs(F,{children:["Set a new password for ",a.fname," ",a.lname," (",a.username,")"]})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[Object.keys(o).length>0&&e.jsxs(p,{variant:"destructive",className:"mb-4",children:[e.jsx(N,{children:"Unable to process request"}),e.jsx(g,{children:Object.values(o).map((j,H)=>e.jsx("ul",{className:"list-inside list-disc text-sm",children:e.jsx("li",{children:j})},H))})]}),K&&e.jsxs(p,{className:"mb-6 border-green-200 bg-green-50/80 backdrop-blur-sm",children:[e.jsx(Q,{className:"h-4 w-4 text-green-600"}),e.jsx(g,{className:"font-medium text-green-800",children:K})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"password",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(m,{id:"password",type:d?"text":"password",value:u.password,onChange:j=>x("password",j.target.value),placeholder:"Enter new password",className:"pr-10",disabled:s}),e.jsx(c,{type:"button",variant:"ghost",size:"sm",className:"absolute top-0 right-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>n(!d),disabled:s,children:d?e.jsx(M,{className:"h-4 w-4"}):e.jsx(z,{className:"h-4 w-4"})})]}),o.password&&e.jsx("p",{className:"text-sm text-destructive",children:o.password})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"password_confirmation",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(m,{id:"password_confirmation",type:r?"text":"password",value:u.password_confirmation,onChange:j=>x("password_confirmation",j.target.value),placeholder:"Confirm new password",className:"pr-10",disabled:s}),e.jsx(c,{type:"button",variant:"ghost",size:"sm",className:"absolute top-0 right-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>i(!r),disabled:s,children:r?e.jsx(M,{className:"h-4 w-4"}):e.jsx(z,{className:"h-4 w-4"})})]}),o.password_confirmation&&e.jsx("p",{className:"text-sm text-destructive",children:o.password_confirmation})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(c,{variant:"outline",onClick:()=>h(!1),disabled:s,children:"Cancel"}),e.jsxs(c,{onClick:V,disabled:s,className:"gap-2",children:[s&&e.jsx(X,{className:"h-4 w-4 animate-spin"}),"Set New Password"]})]})]})]})]})}const le=[{accessorKey:"fname",header:"First Name"},{accessorKey:"mname",header:"Middle Name",cell:({row:a})=>a.getValue("mname")||e.jsx("span",{className:"text-muted-foreground",children:"N/A"})},{accessorKey:"lname",header:"Last Name"},{accessorKey:"contactnum",header:"Contact No."},{accessorKey:"avatar",header:"Avatar",cell:({row:a})=>{const t=a.getValue("avatar");return t?e.jsx("img",{src:`/storage/${t}`,alt:"Avatar",className:"h-8 w-8 rounded-full object-cover"}):e.jsx("span",{className:"text-muted-foreground",children:"N/A"})}},{accessorKey:"username",header:"Username"},{accessorKey:"position",header:"Position"},{accessorKey:"agency",header:"Agency"},{accessorKey:"password",header:"Request Password Reset",cell:({row:a})=>{const t=a.original;return t.password_resets&&t.password_resets.length>0?e.jsx(te,{user:t}):e.jsx("span",{className:"text-muted-foreground",children:"No active request"})}},{id:"actions",header:"Actions",cell:({row:a})=>{const t=a.original;return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ne,{user:t}),e.jsx(re,{user:t})]})}}];function ce(){const{data:a,setData:t,post:h,processing:d}=b({agency_name:""}),n=i=>{i.preventDefault(),i.stopPropagation(),h(route("agency.create"),{preserveScroll:!0,onSuccess:()=>{t("agency_name","")}})},r=i=>{i.stopPropagation()};return e.jsxs(C,{children:[e.jsx(S,{asChild:!0,children:e.jsx(c,{variant:"outline",className:"w-full",onClick:r,type:"button",children:"Add Agency"})}),e.jsxs(A,{children:[e.jsxs(D,{children:[e.jsx(k,{children:"Add Agency"}),e.jsx(F,{children:"Fill in the details to add a new agency."})]}),e.jsxs("form",{id:"add-agency-form",className:"space-y-4",onSubmit:n,children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"agencyName",children:"Agency Name *"}),e.jsx(m,{id:"agency_name",name:"agency_name",value:a.agency_name,onChange:i=>t("agency_name",i.target.value),required:!0})]}),e.jsxs(U,{children:[e.jsx(_,{asChild:!0,children:e.jsx(c,{variant:"secondary",type:"button",children:"Cancel"})}),e.jsx(c,{type:"submit",form:"add-agency-form",disabled:d,children:d?"Adding...":"Add Agency"})]})]})]})]})}function ie({agencies:a}){const t=f.useRef(null),{props:h}=w(),d=h.success,{data:n,setData:r,post:i,processing:u,errors:x}=b({fname:"",mname:"",lname:"",contactnum:"",avatar:null,username:"",password:"",position:"",agency:""}),y=s=>{s.preventDefault(),i(route("user-management.store"),{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{r({fname:"",mname:"",lname:"",contactnum:"",avatar:null,username:"",password:"",position:"",agency:""}),setTimeout(()=>{const o=document.querySelector(".dialog-close-button");o&&o.click()},3e3)}})};return e.jsxs(C,{children:[e.jsx(R,{title:"Create User"}),e.jsx(S,{asChild:!0,children:e.jsx(c,{variant:"outline",children:"Add User"})}),e.jsx(A,{className:"sm:max-w-3xl",children:e.jsxs("form",{id:"create-user-form",onSubmit:y,children:[e.jsxs(D,{children:[e.jsx(k,{children:"Create User"}),e.jsx(F,{children:"Fill in the details to create a new user."})]}),Object.keys(x).length>0&&e.jsxs(p,{variant:"destructive",className:"mt-4 mb-4",children:[e.jsx(N,{children:"Unable to process request"}),e.jsx(g,{children:Object.values(x).map((s,o)=>e.jsx("ul",{className:"list-inside list-disc text-sm",children:e.jsx("li",{children:s})},o))})]}),d&&e.jsxs(p,{variant:"default",className:"mb-4",children:[e.jsx(N,{children:"Success"}),e.jsx(g,{children:d})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 py-2",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx(l,{htmlFor:"firstName",children:"First Name *"}),e.jsx(m,{id:"fname",name:"fname",value:n.fname,onChange:s=>r("fname",s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"middleName",children:"Middle Name"}),e.jsx(m,{id:"middleName",name:"mname",value:n.mname,onChange:s=>r("mname",s.target.value)})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(l,{htmlFor:"lastName",children:"Last Name *"}),e.jsx(m,{id:"lname",name:"lname",value:n.lname,onChange:s=>r("lname",s.target.value),required:!0})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(l,{htmlFor:"contactNumber",children:"Contact Number *"}),e.jsx(m,{id:"contactnum",name:"contactnum",value:n.contactnum,onChange:s=>r("contactnum",s.target.value),required:!0})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(l,{htmlFor:"avatar",children:"Avatar *"}),e.jsx(m,{id:"avatar",name:"avatar",type:"file",ref:t,onChange:s=>{var o;return r("avatar",((o=s.target.files)==null?void 0:o[0])??null)},accept:"image/*"})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(l,{htmlFor:"username",children:"Username *"}),e.jsx(m,{id:"username",name:"username",value:n.username,onChange:s=>r("username",s.target.value),required:!0})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(l,{htmlFor:"password",children:"Password *"}),e.jsx(m,{id:"password",name:"password",type:"password",value:n.password,onChange:s=>r("password",s.target.value),required:!0})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(l,{htmlFor:"userType",children:"User Type *"}),e.jsxs(q,{value:n.position,onValueChange:s=>r("position",s),required:!0,children:[e.jsx(P,{children:e.jsx(L,{placeholder:"Select user type"})}),e.jsxs(E,{children:[e.jsx(v,{value:"law-enforcement",children:"Law Enforcement"}),e.jsx(v,{value:"admin",children:"Administrator"}),e.jsx(v,{value:"record-officer",children:"Records Officer"})]})]})]}),e.jsxs("div",{className:"col-span-3 grid grid-cols-3 items-end gap-4 py-2",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx(l,{htmlFor:"agency",children:"Agency *"}),e.jsxs(q,{value:n.agency,onValueChange:s=>r("agency",s),required:!0,children:[e.jsx(P,{children:e.jsx(L,{placeholder:"Select agency"})}),e.jsx(E,{children:a.map(s=>e.jsx(v,{value:s.agency_name,children:s.agency_name},s.id))})]})]}),e.jsx("div",{className:"col-span-1 flex items-end",children:e.jsx(ce,{})})]})]}),e.jsxs(U,{children:[e.jsx(_,{asChild:!0,children:e.jsx(c,{variant:"secondary",children:"Cancel"})}),e.jsx(c,{type:"submit",form:"create-user-form",className:"bg-blue-500 hover:bg-blue-600",disabled:u,children:u?"Creating...":"Create User"})]})]})})]})}const de=[{title:"Dashboard",href:"/dashboard"}];function _e(){const{users:a,filters:t,agencies:h}=w().props,[d,n]=f.useState(t.search||""),r=()=>{O.get("/admin/user-management",{search:d},{preserveState:!0})};return e.jsxs(G,{breadcrumbs:de,children:[e.jsx(R,{title:"User Management"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"User Management"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage your users and their permissions."})]}),e.jsx(ie,{agencies:h})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(l,{htmlFor:"search",className:"text-sm font-medium",children:"Search Users"}),e.jsx(m,{id:"search",placeholder:"Search by name or username",className:"w-64",value:d,onChange:i=>n(i.target.value),onKeyDown:i=>i.key==="Enter"&&r()}),e.jsx(c,{variant:"outline",onClick:r,children:"Search"})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(J,{columns:le,data:a.data}),e.jsx(ae,{page:a.current_page,totalPages:a.last_page,onPageChange:i=>O.get("/admin/user-management",{search:t.search,page:i},{preserveState:!0})})]})]})]})}export{_e as default};
