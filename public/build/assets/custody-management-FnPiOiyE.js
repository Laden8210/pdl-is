import{K as T,m as S,j as e,L}from"./app-Cw2Ola3T.js";import{A as D,b as v,a as M}from"./alert-CFenGozM.js";import{c as P,B as x}from"./button-HtDwNjna.js";import{D as F,i as I,a as R,b as G,c as Y,d as E,g as H,h as O}from"./app-layout-B1I5xyFJ.js";import{I as _}from"./input-C-67zMx9.js";import{L as C}from"./label-Cw4YEQsI.js";import{C as g}from"./scale-Bevs8Hfo.js";import{n as U,d as $,f as k}from"./format-B3rlCQGj.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],z=P("CalendarDays",q);function B(s,r,i){const[t,d]=U(i==null?void 0:i.in,s,r),l=w(t,d),o=Math.abs($(t,d));t.setDate(t.getDate()-l*o);const c=+(w(t,d)===-l),m=l*(o-c);return m===0?0:m}function w(s,r){const i=s.getFullYear()-r.getFullYear()||s.getMonth()-r.getMonth()||s.getDate()-r.getDate()||s.getHours()-r.getHours()||s.getMinutes()-r.getMinutes()||s.getSeconds()-r.getSeconds()||s.getMilliseconds()-r.getMilliseconds();return i<0?-1:i>0?1:i}function ae({pdl:s}){var j;const{props:r}=T(),i=r.success;console.log("PDL Data in CustodyManagement:",s.court_orders[0].admission_date);const{data:t,setData:d,post:l,processing:o,errors:c,reset:m}=S({admission_date:(j=s==null?void 0:s.court_orders[0])!=null&&j.admission_date?k(new Date(s.court_orders[0].admission_date),"yyyy-MM-dd"):"",release_date:s!=null&&s.release_date?k(new Date(s.release_date),"yyyy-MM-dd"):""}),A=a=>{a.preventDefault(),l(route("admin.custody.update",s.id),{preserveScroll:!0,onSuccess:()=>{m()}})},n=(()=>{if(!t.admission_date)return null;const a=new Date(t.admission_date),h=t.release_date?new Date(t.release_date):new Date,u=B(h,a),f=Math.floor(u/365),p=u%365,b=Math.floor(p/30),N=p%30;return{totalDays:u,years:f,months:b,days:N,formatted:`${f} years ${b} months ${N} days`,isReleased:!!t.release_date}})(),y=a=>a>=1&&a<=2?20:a>=3&&a<=5?23:a>=6&&a<=10?25:a>=11?30:0;return e.jsxs(F,{children:[e.jsx(L,{title:"Custody Management"}),e.jsx(I,{asChild:!0,children:e.jsxs(x,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4"}),"Manage Custody"]})}),e.jsx(R,{className:"sm:max-w-[600px]",children:e.jsxs("form",{id:"custody-form",onSubmit:A,children:[e.jsxs(G,{children:[e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(g,{className:"h-5 w-5"}),"Custody Management for ",s.fname," ",s.lname]}),e.jsx(E,{children:"Set admission and release dates to track custody period and calculate time allowances."})]}),Object.keys(c).length>0&&e.jsxs(D,{variant:"destructive",className:"mb-4 mt-4",children:[e.jsx(v,{children:"Unable to process request"}),e.jsx(M,{children:Object.values(c).map((a,h)=>e.jsx("ul",{className:"list-inside list-disc text-sm",children:e.jsx("li",{children:String(a)})},h))})]}),i&&e.jsxs(D,{variant:"default",className:"mb-4 border-green-200 bg-green-50 text-green-800",children:[e.jsx(v,{children:"Success"}),e.jsx(M,{children:i})]}),n&&e.jsxs("div",{className:"bg-blue-50 p-4 rounded-md border border-blue-200 mb-4",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-800 mb-2",children:"Custody Period"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-blue-700",children:[e.jsx("strong",{children:"Total Days:"})," ",n.totalDays," days"]}),e.jsxs("p",{className:"text-blue-700",children:[e.jsx("strong",{children:"Period:"})," ",n.formatted]})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-blue-700",children:[e.jsx("strong",{children:"Status:"})," ",n.isReleased?"Released":"Currently in custody"]}),e.jsxs("p",{className:"text-blue-700",children:[e.jsx("strong",{children:"GCTA Default:"})," ",y(n.years)," days/month"]})]})]})]}),e.jsxs("div",{className:"grid gap-4 py-2",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(C,{htmlFor:"admission_date",children:"Admission Date"}),e.jsxs("div",{className:"relative",children:[e.jsx(g,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(_,{id:"admission_date",name:"admission_date",type:"date",value:t.admission_date,onChange:a=>d("admission_date",a.target.value),className:"pl-10",required:!0})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(C,{htmlFor:"release_date",children:"Release Date (Optional)"}),e.jsxs("div",{className:"relative",children:[e.jsx(g,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(_,{id:"release_date",name:"release_date",type:"date",value:t.release_date,onChange:a=>d("release_date",a.target.value),className:"pl-10"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Leave empty if PDL is still in custody"})]})]}),n&&n.years>0&&e.jsxs("div",{className:"bg-gray-50 p-4 rounded-md border border-gray-200 mb-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-800 mb-2",children:"Time Allowance Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-gray-700",children:[e.jsx("strong",{children:"GCTA Eligibility:"})," ",n.years>=1?"Yes":"No"]}),e.jsxs("p",{className:"text-gray-700",children:[e.jsx("strong",{children:"Default GCTA:"})," ",y(n.years)," days/month"]})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-gray-700",children:[e.jsx("strong",{children:"TASTM Eligibility:"})," Yes"]}),e.jsxs("p",{className:"text-gray-700",children:[e.jsx("strong",{children:"Default TASTM:"})," 15 days/year"]})]})]})]}),e.jsxs(H,{children:[e.jsx(O,{asChild:!0,children:e.jsx(x,{variant:"secondary",children:"Cancel"})}),e.jsx(x,{type:"submit",form:"custody-form",className:"bg-blue-500 hover:bg-blue-600",disabled:o,children:o?"Updating...":"Update Custody Dates"})]})]})})]})}export{ae as C};
