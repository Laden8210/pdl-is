import{m as f,j as e,S as y,K as k,r as K,L as O}from"./app-D7sJuwJc.js";import{D as U}from"./data-table-Cnc7GZMm.js";import{C as V,a as $,b as B,c as H}from"./card-DLWDwqHf.js";import{I as j}from"./input-BS_xsQ9S.js";import{L as n}from"./label-Br4WJ6FG.js";import{D as N,e as C,a as D,b,c as w,d as S,f as F,g as M,A as z}from"./app-layout-l1YM3YbX.js";import{B as h}from"./button-u9ZiHX7C.js";import{A as R,b as L,a as P}from"./alert-Cr1nbU3H.js";import{S as q,a as _,b as T,c as E,d as I}from"./select-BBZMYkik.js";import{T as c}from"./textarea-BmLTENgj.js";import{D as G,a as J,E as Q,b as W,c as X,d as v}from"./dropdown-menu-BQjRxx1t.js";import{f as Y}from"./format-B3rlCQGj.js";import"./table-C22pG3nj.js";import"./index-LOQAaJzy.js";import"./users-BxYB4q2L.js";import"./user-CmeQLBVE.js";import"./scale-DVrI9DmE.js";import"./eye-B8lowLFn.js";import"./index-BHiRKjcJ.js";import"./index-BFvJa6MF.js";function Z({pdls:a=[]}){const{data:i,setData:t,post:l,processing:d,errors:o,reset:m}=f({pdl_id:"",complaint:"",date:new Date().toISOString().split("T")[0],prognosis:"",laboratory:"",prescription:"",findings:""}),p=s=>{s.preventDefault(),l(route("medical-records.store"),{preserveScroll:!0,onSuccess:()=>m()})};return e.jsxs(N,{children:[e.jsx(C,{asChild:!0,children:e.jsx(h,{variant:"outline",children:"Create Record"})}),e.jsxs(D,{className:"sm:max-w-3xl",children:[e.jsxs(b,{children:[e.jsx(w,{children:"Create Medical Record"}),e.jsx(S,{children:"Fill in the medical details"})]}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[Object.keys(o).length>0&&e.jsxs(R,{variant:"destructive",children:[e.jsx(L,{children:"Error"}),e.jsx(P,{children:e.jsx("ul",{className:"list-inside list-disc",children:Object.values(o).map((s,r)=>e.jsx("li",{children:s},r))})})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"PDL (Person Deprived of Liberty)"}),e.jsxs(q,{value:i.pdl_id,onValueChange:s=>t("pdl_id",s),required:!0,children:[e.jsx(_,{children:e.jsx(T,{placeholder:"Select a PDL"})}),e.jsx(E,{children:a.map(s=>e.jsxs(I,{value:s.id.toString(),children:[s.fname," ",s.lname," (ID: ",s.id,")"]},s.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"date",children:"Date"}),e.jsx(j,{type:"date",id:"date",value:i.date,onChange:s=>t("date",s.target.value),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"complaint",children:"Complaint"}),e.jsx(c,{id:"complaint",value:i.complaint,onChange:s=>t("complaint",s.target.value),required:!0,rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"findings",children:"Findings"}),e.jsx(c,{id:"findings",value:i.findings,onChange:s=>t("findings",s.target.value),required:!0,rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"prognosis",children:"Prognosis"}),e.jsx(c,{id:"prognosis",value:i.prognosis,onChange:s=>t("prognosis",s.target.value),required:!0,rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"laboratory",children:"Laboratory Results"}),e.jsx(c,{id:"laboratory",value:i.laboratory,onChange:s=>t("laboratory",s.target.value),required:!0,rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"prescription",children:"Prescription"}),e.jsx(c,{id:"prescription",value:i.prescription,onChange:s=>t("prescription",s.target.value),required:!0,rows:3})]}),e.jsxs(F,{children:[e.jsx(M,{asChild:!0,children:e.jsx(h,{variant:"outline",children:"Cancel"})}),e.jsx(h,{type:"submit",disabled:d,children:d?"Creating...":"Create Record"})]})]})]})]})}function ee({record:a,pdls:i}){const{data:t,setData:l,put:d,processing:o,errors:m,reset:p}=f({pdl_id:a.pdl_id.toString(),complaint:a.complaint,date:a.date.split("T")[0],progonosis:a.progonosis,laboratory:a.laboratory,prescription:a.prescription,findings:a.findings}),s=r=>{r.preventDefault(),d(route("medical-records.update",a.medical_record_id),{preserveScroll:!0,onSuccess:()=>p()})};return e.jsxs(N,{children:[e.jsx(C,{asChild:!0,children:e.jsx(h,{variant:"ghost",className:"w-full justify-start",children:"Edit"})}),e.jsxs(D,{className:"sm:max-w-3xl",children:[e.jsxs(b,{children:[e.jsx(w,{children:"Edit Medical Record"}),e.jsx(S,{children:"Update the medical details"})]}),e.jsxs("form",{onSubmit:s,className:"space-y-4",children:[Object.keys(m).length>0&&e.jsxs(R,{variant:"destructive",children:[e.jsx(L,{children:"Error"}),e.jsx(P,{children:e.jsx("ul",{className:"list-inside list-disc",children:Object.values(m).map((r,x)=>e.jsx("li",{children:r},x))})})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"PDL (Person Deprived of Liberty)"}),e.jsxs(q,{value:t.pdl_id,onValueChange:r=>l("pdl_id",r),required:!0,children:[e.jsx(_,{children:e.jsx(T,{placeholder:"Select a PDL"})}),e.jsx(E,{children:i.map(r=>e.jsxs(I,{value:r.id.toString(),children:[r.fname," ",r.lname," (ID: ",r.id,")"]},r.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"date",children:"Date"}),e.jsx(j,{type:"date",id:"date",value:t.date,onChange:r=>l("date",r.target.value),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"complaint",children:"Complaint"}),e.jsx(c,{id:"complaint",value:t.complaint,onChange:r=>l("complaint",r.target.value),required:!0,rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"findings",children:"Findings"}),e.jsx(c,{id:"findings",value:t.findings,onChange:r=>l("findings",r.target.value),required:!0,rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"progonosis",children:"Progonosis"}),e.jsx(c,{id:"progonosis",value:t.progonosis,onChange:r=>l("progonosis",r.target.value),required:!0,rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"laboratory",children:"Laboratory Results"}),e.jsx(c,{id:"laboratory",value:t.laboratory,onChange:r=>l("laboratory",r.target.value),required:!0,rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"prescription",children:"Prescription"}),e.jsx(c,{id:"prescription",value:t.prescription,onChange:r=>l("prescription",r.target.value),required:!0,rows:3})]}),e.jsxs(F,{children:[e.jsx(M,{asChild:!0,children:e.jsx(h,{variant:"outline",children:"Cancel"})}),e.jsx(h,{type:"submit",disabled:o,children:o?"Updating...":"Update Record"})]})]})]})]})}const se=[{accessorKey:"date",header:"Date",cell:({row:a})=>Y(new Date(a.original.date),"MMM dd, yyyy")},{id:"pdl",header:"PDL",cell:({row:a})=>{const i=a.original.pdl;return i?`${i.fname} ${i.lname}`:`ID: ${a.original.pdl_id}`}},{accessorKey:"complaint",header:"Complaint",cell:({row:a})=>e.jsx("div",{className:"max-w-[200px] truncate",children:a.original.complaint})},{accessorKey:"findings",header:"Findings",cell:({row:a})=>e.jsx("div",{className:"max-w-[200px] truncate",children:a.original.findings})},{accessorKey:"prognosis",header:"Prognosis",cell:({row:a})=>e.jsx("div",{className:"max-w-[200px] truncate",children:a.original.prognosis})},{id:"actions",header:"Actions",cell:({row:a})=>{const i=a.original;return e.jsxs(G,{children:[e.jsx(J,{asChild:!0,children:e.jsxs(h,{variant:"ghost",size:"icon",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(Q,{className:"h-4 w-4"})]})}),e.jsxs(W,{align:"end",children:[e.jsx(X,{children:"Actions"}),e.jsx(v,{asChild:!0,children:e.jsx(ee,{record:i,pdls:[]})}),e.jsx(v,{onClick:()=>y.delete(route("medical-records.destroy",i.medical_record_id)),className:"text-red-500",children:"Delete"})]})]})}}],re=[{title:"Medical Records",href:"/medical-records"}];function De(){const{props:a}=k(),{records:i,pdls:t,filters:l,auth:d,searchPerformed:o,totalResults:m}=a,[p,s]=K.useState((l==null?void 0:l.search)||""),r=()=>{var g;switch((g=d==null?void 0:d.user)==null?void 0:g.position){case"admin":return"/admin/pdl-management/medical-records";case"law-enforcement":return"/law-enforcement/pdl-management/medical-records";case"record-officer":default:return"/record-officer/pdl-management/medical-records"}},x=()=>{y.get(r(),{search:p},{preserveState:!0,replace:!0})},A=u=>{u.key==="Enter"&&x()};return e.jsxs(z,{breadcrumbs:re,children:[e.jsx(O,{title:"Medical Records Management"}),e.jsxs("div",{className:"flex flex-col gap-6 p-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Medical Records"}),e.jsxs(V,{children:[e.jsx($,{children:e.jsx(B,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Medical Records"}),e.jsx(Z,{pdls:t})]})})}),e.jsxs(H,{children:[e.jsxs("div",{className:"mb-4 flex items-center space-x-4",children:[e.jsx(n,{htmlFor:"search",className:"text-sm font-medium",children:"Search Records"}),e.jsx(j,{id:"search",placeholder:"Search by complaint, PDL name, findings, etc.",className:"w-64 md:w-96",value:p,onChange:u=>s(u.target.value),onKeyDown:A}),e.jsx(h,{variant:"outline",onClick:x,children:"Search"})]}),e.jsx(U,{data:i??[],columns:se}),o&&e.jsx("div",{className:"mt-4 text-center",children:m===0?e.jsxs("div",{className:"text-muted-foreground",children:[e.jsx("p",{className:"text-lg font-medium",children:"No medical records found"}),e.jsxs("p",{className:"mt-2",children:['No medical records match your search criteria: "',l==null?void 0:l.search,'"']}),e.jsx("p",{className:"mt-1 text-sm",children:"Try searching with different keywords or check your spelling."})]}):e.jsx("div",{className:"text-muted-foreground",children:e.jsxs("p",{className:"text-sm",children:["Found ",m," medical record",m!==1?"s":"",' matching "',l==null?void 0:l.search,'"']})})}),!o&&i.length===0&&e.jsxs("div",{className:"mt-4 text-center text-muted-foreground",children:[e.jsx("p",{className:"text-lg font-medium",children:"No medical records found"}),e.jsx("p",{className:"mt-2",children:"Medical records will appear here once they are created."})]})]})]})]})]})}export{De as default};
