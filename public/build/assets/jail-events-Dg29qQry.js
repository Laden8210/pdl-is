import{m as K,j as e,K as ve,r as p,L as be}from"./app-BPxrKEyb.js";import{D as P,i as ne,X as W,a as O,b as $,c as U,d as Y,g as X,h as le,C as te,A as ye}from"./app-layout-B7fNkZnx.js";import{C as je}from"./checkbox-qAUtApyq.js";import{I}from"./input-CvRLkRAD.js";import{L}from"./label-BHAojcQv.js";import{D as Ne,m as se,g as F,y as h,S as we,V as Ce,c as Q,s as Se,d as De,f as oe,e as ke,h as Te,N as Ee,j as _e,k as ae,B as de,l as Ae,n as re,o as Le,_ as ce,E as Ie,p as ue,q as Me,r as V,t as Re,u as He,v as Fe,w as H,C as Pe,F as Oe,i as $e,a as Ue,b as Ge}from"./create-event-BddEFulK.js";import{c as ze,B as _}from"./button-CEMgu7CE.js";import{T as Be}from"./textarea-C2McMECy.js";import{f as E}from"./format-B3rlCQGj.js";import{B as q}from"./badge-CwiTgdPp.js";import{A as Ve,b as qe,a as We}from"./alert-Dy7BgFLC.js";import{S as J}from"./users-HviPfwPA.js";import{C as Je}from"./scale-CeClP0FS.js";import{U as Ke}from"./user-DBhr3jVO.js";import"./index-Bwm_JLZs.js";import"./eye-DJMTalI9.js";import"./circle-alert-BcedVOno.js";import"./index-D55dR1IO.js";import"./index-xw3hog76.js";import"./index-DXqzBNPn.js";import"./index-DEilKMl9.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Xe=ze("Tag",Ye);class Qe extends de{constructor(){super(...arguments),this.state={textId:F()}}render(){let{theme:a,dateEnv:r,options:o,viewApi:i}=this.context,{cellId:d,dayDate:f,todayRange:l}=this.props,{textId:c}=this.state,m=Ae(f,l),b=o.listDayFormat?r.format(f,o.listDayFormat):"",C=o.listDaySideFormat?r.format(f,o.listDaySideFormat):"",y=Object.assign({date:r.toDate(f),view:i,textId:c,text:b,sideText:C,navLinkAttrs:re(this.context,f),sideNavLinkAttrs:re(this.context,f,"day",!1)},m);return h(Q,{elTag:"tr",elClasses:["fc-list-day",...Le(m,a)],elAttrs:{"data-date":oe(f)},renderProps:y,generatorName:"dayHeaderContent",customGenerator:o.dayHeaderContent,defaultGenerator:Ze,classNameGenerator:o.dayHeaderClassNames,didMount:o.dayHeaderDidMount,willUnmount:o.dayHeaderWillUnmount},N=>h("th",{scope:"colgroup",colSpan:3,id:d,"aria-labelledby":c},h(N,{elTag:"div",elClasses:["fc-list-day-cushion",a.getClass("tableCellShaded")]})))}}function Ze(s){return h(ce,null,s.text&&h("a",Object.assign({id:s.textId,className:"fc-list-day-text"},s.navLinkAttrs),s.text),s.sideText&&h("a",Object.assign({"aria-hidden":!0,className:"fc-list-day-side-text"},s.sideNavLinkAttrs),s.sideText))}const et=ue({hour:"numeric",minute:"2-digit",meridiem:"short"});class tt extends de{render(){let{props:a,context:r}=this,{options:o}=r,{seg:i,timeHeaderId:d,eventHeaderId:f,dateHeaderId:l}=a,c=o.eventTimeFormat||et;return h(Ie,Object.assign({},a,{elTag:"tr",elClasses:["fc-list-event",i.eventRange.def.url&&"fc-event-forced-url"],defaultGenerator:()=>st(i,r),seg:i,timeText:"",disableDragging:!0,disableResizing:!0}),(m,b)=>h(ce,null,at(i,c,r,d,l),h("td",{"aria-hidden":!0,className:"fc-list-event-graphic"},h("span",{className:"fc-list-event-dot",style:{borderColor:b.borderColor||b.backgroundColor}})),h(m,{elTag:"td",elClasses:["fc-list-event-title"],elAttrs:{headers:`${f} ${l}`}})))}}function st(s,a){let r=Re(s,a);return h("a",Object.assign({},r),s.eventRange.def.title)}function at(s,a,r,o,i){let{options:d}=r;if(d.displayEventTime!==!1){let f=s.eventRange.def,l=s.eventRange.instance,c=!1,m;if(f.allDay?c=!0:Me(s.eventRange.range)?s.isStart?m=V(s,a,r,null,null,l.range.start,s.end):s.isEnd?m=V(s,a,r,null,null,s.start,l.range.end):c=!0:m=V(s,a,r),c){let b={text:r.options.allDayText,view:r.viewApi};return h(Q,{elTag:"td",elClasses:["fc-list-event-time"],elAttrs:{headers:`${o} ${i}`},renderProps:b,generatorName:"allDayContent",customGenerator:d.allDayContent,defaultGenerator:rt,classNameGenerator:d.allDayClassNames,didMount:d.allDayDidMount,willUnmount:d.allDayWillUnmount})}return h("td",{className:"fc-list-event-time"},m)}return null}function rt(s){return s.text}class it extends Ne{constructor(){super(...arguments),this.computeDateVars=se(lt),this.eventStoreToSegs=se(this._eventStoreToSegs),this.state={timeHeaderId:F(),eventHeaderId:F(),dateHeaderIdRoot:F()},this.setRootEl=a=>{a?this.context.registerInteractiveComponent(this,{el:a}):this.context.unregisterInteractiveComponent(this)}}render(){let{props:a,context:r}=this,{dayDates:o,dayRanges:i}=this.computeDateVars(a.dateProfile),d=this.eventStoreToSegs(a.eventStore,a.eventUiBases,i);return h(Ce,{elRef:this.setRootEl,elClasses:["fc-list",r.theme.getClass("table"),r.options.stickyHeaderDates!==!1?"fc-list-sticky":""],viewSpec:r.viewSpec},h(we,{liquid:!a.isHeightAuto,overflowX:a.isHeightAuto?"visible":"hidden",overflowY:a.isHeightAuto?"visible":"auto"},d.length>0?this.renderSegList(d,o):this.renderEmptyMessage()))}renderEmptyMessage(){let{options:a,viewApi:r}=this.context,o={text:a.noEventsText,view:r};return h(Q,{elTag:"div",elClasses:["fc-list-empty"],renderProps:o,generatorName:"noEventsContent",customGenerator:a.noEventsContent,defaultGenerator:nt,classNameGenerator:a.noEventsClassNames,didMount:a.noEventsDidMount,willUnmount:a.noEventsWillUnmount},i=>h(i,{elTag:"div",elClasses:["fc-list-empty-cushion"]}))}renderSegList(a,r){let{theme:o,options:i}=this.context,{timeHeaderId:d,eventHeaderId:f,dateHeaderIdRoot:l}=this.state,c=ot(a);return h(Ee,{unit:"day"},(m,b)=>{let C=[];for(let y=0;y<c.length;y+=1){let N=c[y];if(N){let j=oe(r[y]),S=l+"-"+j;C.push(h(Qe,{key:j,cellId:S,dayDate:r[y],todayRange:b})),N=ke(N,i.eventOrder);for(let w of N)C.push(h(tt,Object.assign({key:j+":"+w.eventRange.instance.instanceId,seg:w,isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:!1,timeHeaderId:d,eventHeaderId:f,dateHeaderId:S},Te(w,b,m))))}}return h("table",{className:"fc-list-table "+o.getClass("table")},h("thead",null,h("tr",null,h("th",{scope:"col",id:d},i.timeHint),h("th",{scope:"col","aria-hidden":!0}),h("th",{scope:"col",id:f},i.eventHint))),h("tbody",null,C))})}_eventStoreToSegs(a,r,o){return this.eventRangesToSegs(Se(a,r,this.props.dateProfile.activeRange,this.context.options.nextDayThreshold).fg,o)}eventRangesToSegs(a,r){let o=[];for(let i of a)o.push(...this.eventRangeToSegs(i,r));return o}eventRangeToSegs(a,r){let{dateEnv:o}=this.context,{nextDayThreshold:i}=this.context.options,d=a.range,f=a.def.allDay,l,c,m,b=[];for(l=0;l<r.length;l+=1)if(c=De(d,r[l]),c&&(m={component:this,eventRange:a,start:c.start,end:c.end,isStart:a.isStart&&c.start.valueOf()===d.start.valueOf(),isEnd:a.isEnd&&c.end.valueOf()===d.end.valueOf(),dayIndex:l},b.push(m),!m.isEnd&&!f&&l+1<r.length&&d.end<o.add(r[l+1].start,i))){m.end=d.end,m.isEnd=!0;break}return b}}function nt(s){return s.text}function lt(s){let a=_e(s.renderRange.start),r=s.renderRange.end,o=[],i=[];for(;a<r;)o.push(a),i.push({start:a,end:ae(a,1)}),a=ae(a,1);return{dayDates:o,dayRanges:i}}function ot(s){let a=[],r,o;for(r=0;r<s.length;r+=1)o=s[r],(a[o.dayIndex]||(a[o.dayIndex]=[])).push(o);return a}var dt=':root{--fc-list-event-dot-width:10px;--fc-list-event-hover-bg-color:#f5f5f5}.fc-theme-standard .fc-list{border:1px solid var(--fc-border-color)}.fc .fc-list-empty{align-items:center;background-color:var(--fc-neutral-bg-color);display:flex;height:100%;justify-content:center}.fc .fc-list-empty-cushion{margin:5em 0}.fc .fc-list-table{border-style:hidden;width:100%}.fc .fc-list-table tr>*{border-left:0;border-right:0}.fc .fc-list-sticky .fc-list-day>*{background:var(--fc-page-bg-color);position:sticky;top:0}.fc .fc-list-table thead{left:-10000px;position:absolute}.fc .fc-list-table tbody>tr:first-child th{border-top:0}.fc .fc-list-table th{padding:0}.fc .fc-list-day-cushion,.fc .fc-list-table td{padding:8px 14px}.fc .fc-list-day-cushion:after{clear:both;content:"";display:table}.fc-theme-standard .fc-list-day-cushion{background-color:var(--fc-neutral-bg-color)}.fc-direction-ltr .fc-list-day-text,.fc-direction-rtl .fc-list-day-side-text{float:left}.fc-direction-ltr .fc-list-day-side-text,.fc-direction-rtl .fc-list-day-text{float:right}.fc-direction-ltr .fc-list-table .fc-list-event-graphic{padding-right:0}.fc-direction-rtl .fc-list-table .fc-list-event-graphic{padding-left:0}.fc .fc-list-event.fc-event-forced-url{cursor:pointer}.fc .fc-list-event:hover td{background-color:var(--fc-list-event-hover-bg-color)}.fc .fc-list-event-graphic,.fc .fc-list-event-time{white-space:nowrap;width:1px}.fc .fc-list-event-dot{border:calc(var(--fc-list-event-dot-width)/2) solid var(--fc-event-border-color);border-radius:calc(var(--fc-list-event-dot-width)/2);box-sizing:content-box;display:inline-block;height:0;width:0}.fc .fc-list-event-title a{color:inherit;text-decoration:none}.fc .fc-list-event.fc-event-forced-url:hover a{text-decoration:underline}';He(dt);const ct={listDayFormat:ie,listDaySideFormat:ie,noEventsClassNames:H,noEventsContent:H,noEventsDidMount:H,noEventsWillUnmount:H};function ie(s){return s===!1?null:ue(s)}var ut=Fe({name:"@fullcalendar/list",optionRefiners:ct,views:{list:{component:it,buttonTextKey:"list",listDayFormat:{month:"long",day:"numeric",year:"numeric"}},listDay:{type:"list",duration:{days:1},listDayFormat:{weekday:"long"}},listWeek:{type:"list",duration:{weeks:1},listDayFormat:{weekday:"long"},listDaySideFormat:{month:"long",day:"numeric",year:"numeric"}},listMonth:{type:"list",duration:{month:1},listDaySideFormat:{weekday:"long"}},listYear:{type:"list",duration:{year:1},listDaySideFormat:{weekday:"long"}}}});function mt({event:s}){console.log(s);const{data:a,setData:r,patch:o,processing:i,reset:d}=K({activity_id:(s==null?void 0:s.activity_id)||"",reason:"",status:"cancelled"}),f=()=>{o(route("admin.jail-events.cancel"),{preserveScroll:!0,onSuccess:()=>{d()},onError:c=>{console.error("Error canceling event:",c)}})},l=c=>{c||d()};return e.jsxs(P,{onOpenChange:l,children:[e.jsx(ne,{asChild:!0,children:e.jsxs(_,{variant:"outline",className:"text-red-600 border-red-200 hover:bg-red-50 hover:text-red-700",children:[e.jsx(W,{className:"w-4 h-4 mr-1"}),"Cancel"]})}),e.jsxs(O,{className:"sm:max-w-md",children:[e.jsxs($,{children:[e.jsxs(U,{className:"text-red-600 flex items-center gap-2",children:[e.jsx(W,{className:"w-5 h-5"}),"Cancel Event"]}),e.jsxs(Y,{children:["You are about to cancel the event:",e.jsxs("span",{className:"font-semibold text-foreground block mt-1",children:['"',(s==null?void 0:s.title)||"",'"']}),"Please provide a reason for cancellation."]})]}),e.jsx("div",{className:"space-y-4 py-2",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"reason",className:"text-sm font-medium",children:"Reason for Cancellation *"}),e.jsx(I,{id:"reason",value:a.reason,onChange:c=>r("reason",c.target.value),placeholder:"Enter your reason here...",className:"resize-none"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This reason will be recorded with the event cancellation."})]})}),e.jsxs(X,{className:"gap-2 sm:gap-1",children:[e.jsx(le,{asChild:!0,children:e.jsx(_,{variant:"outline",disabled:i,children:"Keep Event"})}),e.jsx(_,{onClick:f,disabled:i||!a.reason.trim(),className:"bg-red-600 hover:bg-red-700 focus:ring-red-600",children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Canceling..."]}):"Confirm Cancellation"})]})]})]})}function ht({event:s}){const{data:a,setData:r,post:o,processing:i,errors:d,reset:f}=K({activity_id:(s==null?void 0:s.activity_id)||"",date:s!=null&&s.start?E(new Date(s.start),"yyyy-MM-dd"):"",time:s!=null&&s.start?E(new Date(s.start),"HH:mm"):"",reason:"",status:"rescheduled"}),l=()=>{o(route("admin.jail-events.reschedule"),{preserveScroll:!0,onSuccess:()=>{f()},onError:m=>{console.error("Error rescheduling event:",m)}})},c=m=>{m||f()};return e.jsxs(P,{onOpenChange:c,children:[e.jsx(ne,{asChild:!0,children:e.jsxs(_,{variant:"outline",children:[e.jsx(te,{className:"h-4 w-4 mr-1"}),"Reschedule"]})}),e.jsxs(O,{className:"sm:max-w-md",children:[e.jsxs($,{children:[e.jsxs(U,{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-5 w-5"}),"Reschedule Event"]}),e.jsxs(Y,{children:["Update the date, time, and location for:",e.jsxs("span",{className:"font-semibold text-foreground block mt-1",children:['"',(s==null?void 0:s.title)||"",'"']})]})]}),e.jsxs("div",{className:"space-y-4 py-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"date",className:"text-sm font-medium",children:"Date *"}),e.jsx(I,{id:"date",type:"date",value:a.date,onChange:m=>r("date",m.target.value),className:d.date?"border-red-500":""}),d.date&&e.jsx("p",{className:"text-xs text-red-600",children:d.date})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"time",className:"text-sm font-medium",children:"Time *"}),e.jsx(I,{id:"time",type:"time",value:a.time,onChange:m=>r("time",m.target.value),className:d.time?"border-red-500":""}),d.time&&e.jsx("p",{className:"text-xs text-red-600",children:d.time})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"reason",className:"text-sm font-medium",children:"Reason for Rescheduling *"}),e.jsx(Be,{id:"reason",value:a.reason,onChange:m=>r("reason",m.target.value),placeholder:"Explain why this event needs to be rescheduled...",rows:3,className:d.reason?"border-red-500":""}),d.reason&&e.jsx("p",{className:"text-xs text-red-600",children:d.reason}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This reason will be recorded with the event update."})]}),e.jsxs("div",{className:"p-3 bg-muted/50 rounded-md text-sm",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Current Event Details:"}),e.jsxs("div",{className:"space-y-1 text-muted-foreground",children:[e.jsxs("div",{children:["Date: ",s!=null&&s.start?E(new Date(s.start),"MMMM d, yyyy"):"Not set"]}),e.jsxs("div",{children:["Time: ",s!=null&&s.start?E(new Date(s.start),"h:mm a"):"Not set"]})]})]})]}),e.jsxs(X,{className:"gap-2 sm:gap-1",children:[e.jsx(le,{asChild:!0,children:e.jsx(_,{variant:"outline",disabled:i,children:"Cancel"})}),e.jsx(_,{onClick:l,disabled:i||!a.date||!a.time||!a.reason.trim(),className:"bg-blue-600 hover:bg-blue-700",children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Updating..."]}):"Reschedule Event"})]})]})]})}const ft=[{title:"Dashboard",href:"/dashboard"}];function Ft(){const{props:s}=ve(),{pdls:a=[],activities:r=[]}=s,o=p.useRef(null),[i,d]=p.useState(""),[f,l]=p.useState(!1),[c,m]=p.useState(new Set),[b,C]=p.useState(new Set),y=p.useRef(null),N=p.useMemo(()=>{const t=[],x=new Set;r.forEach(g=>{g.pdls&&g.pdls.forEach(A=>{const pe=`${A.fname} ${A.lname}`;x.add(pe)})}),x.forEach(g=>{t.push({type:"pdl",value:g,label:g})});const T=new Set;r.forEach(g=>{T.add(g.activity_name)}),T.forEach(g=>{t.push({type:"event",value:g,label:g})});const k=new Set;return r.forEach(g=>{k.add(g.category)}),k.forEach(g=>{t.push({type:"category",value:g,label:g.charAt(0).toUpperCase()+g.slice(1).replace("_"," ")})}),t},[r]),j=p.useMemo(()=>{if(!i.trim())return N.slice(0,10);const t=i.toLowerCase();return N.filter(x=>x.value.toLowerCase().includes(t)||x.label.toLowerCase().includes(t)).slice(0,10)},[i,N]),S=p.useMemo(()=>r.map(t=>{var k,g;const x=t.pdls?t.pdls.map(A=>`${A.fname} ${A.lname}`).join(", "):t.pdl?`${t.pdl.fname} ${t.pdl.lname}`:"Unknown PDL",T=[t.activity_name,x,t.category,t.description||"",t.reason||""].join(" ").toLowerCase();return{id:t.activity_id,title:`${t.activity_name} (${((k=t.pdls)==null?void 0:k.length)||1} PDL${(((g=t.pdls)==null?void 0:g.length)||1)>1?"s":""})`,start:`${t.activity_date}T${t.activity_time}`,extendedProps:{description:t.description||"No description provided",pdl:t.pdl,pdls:t.pdls||[],pdlNames:x,category:t.category,reason:t.reason||"No reason provided",searchableText:T},backgroundColor:B(t.category),borderColor:B(t.category),status:t.status,textColor:"#ffffff",className:"hover:shadow-md transition-shadow duration-200"}}),[r]),w=p.useMemo(()=>{if(!i.trim())return S;const t=i.toLowerCase();return S.filter(x=>x.extendedProps.searchableText.includes(t))},[S,i]);p.useEffect(()=>{if(!i.trim()){m(new Set),C(new Set);return}const t=i.toLowerCase(),x=new Set,T=new Set;S.forEach(k=>{if(k.extendedProps.searchableText.includes(t)){x.add(k.id);const g=k.start.toString().split("T")[0];T.add(g)}}),m(x),C(T),o.current&&o.current.getApi().refetchEvents()},[i,S]);const G=t=>({html:`
                <div class="fc-event-main-frame ${c.has(t.event.id)?"highlighted-event":""}">
                    <div class="fc-event-title-container">
                        <div class="fc-event-title fc-sticky">
                            ${t.event.title}
                        </div>
                    </div>
                </div>
            `}),M=t=>({html:`<div class="fc-daygrid-day-number">${t.dayNumberText}</div>`}),[u,R]=p.useState(null),[z,n]=p.useState(!1),[v,D]=p.useState("");function B(t){switch(t.toLowerCase()){case"court_hearing":case"court hearing":return"#3b82f6";case"medical":return"#ef4444";case"rehabilitation":return"#f59e0b";case"transfer":return"#8b5cf6";case"jail_activity":case"jail activity":return"#8b5cf6";default:return"#6b7280"}}function me(t){switch(t.toLowerCase()){case"pending":return"#f59e0b";case"completed":return"#3b82f6";case"cancelled":return"#ef4444";case"rescheduled":return"#f59e0b";default:return"#6b7280"}}const he=t=>{const x=t.dateStr;D(x),n(!0)},fe=()=>{d(""),l(!1)},Z=t=>{d(t.value),l(!1)},xe=t=>{d(t),l(!0)};p.useEffect(()=>{const t=x=>{y.current&&!y.current.contains(x.target)&&l(!1)};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[]);const ee=t=>{switch(t){case"pdl":return e.jsx(Ke,{className:"h-4 w-4 text-blue-500"});case"event":return e.jsx(Je,{className:"h-4 w-4 text-green-500"});case"category":return e.jsx(Xe,{className:"h-4 w-4 text-purple-500"});default:return e.jsx(J,{className:"h-4 w-4 text-gray-500"})}},ge=t=>{switch(t){case"pdl":return"PDL";case"event":return"Event";case"category":return"Category";default:return t}};return e.jsxs(ye,{breadcrumbs:ft,children:[e.jsx(be,{title:"Calendar"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 p-4",children:[e.jsxs("div",{className:"flex flex-col justify-between gap-4 md:flex-row md:items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Court Hearings & Jail Activities"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage and view all scheduled activities. Double-click on a date to add a new event."})]}),e.jsx(Pe,{pdls:a})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative max-w-md flex-1",ref:y,children:[e.jsx(J,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(I,{ref:y,placeholder:"Search by PDL name, event, or category...",value:i,onChange:t=>xe(t.target.value),onFocus:()=>l(!0),className:"pr-9 pl-9"}),i&&e.jsx("button",{onClick:fe,className:"absolute top-1/2 right-3 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:e.jsx(W,{className:"h-4 w-4"})}),f&&j.length>0&&e.jsx("div",{className:"absolute z-50 mt-1 w-full rounded-md border bg-popover shadow-md",children:e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"px-2 py-1 text-xs font-medium text-muted-foreground",children:["Suggestions (",j.length,")"]}),j.map((t,x)=>e.jsxs("button",{type:"button",onClick:()=>Z(t),className:"flex w-full items-center gap-3 rounded-sm px-2 py-2 text-sm hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground",children:[ee(t.type),e.jsxs("div",{className:"flex flex-1 flex-col items-start",children:[e.jsx("span",{className:"font-medium",children:t.label}),e.jsx("span",{className:"text-xs text-muted-foreground capitalize",children:ge(t.type)})]})]},x))]})}),f&&i&&j.length===0&&e.jsxs("div",{className:"absolute z-50 mt-1 w-full rounded-md border bg-popover p-4 text-sm text-muted-foreground shadow-md",children:['No results found for "',i,'"']})]}),i&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:[w.length," event",w.length!==1?"s":""," found"]})]}),!i&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Quick search:"}),N.slice(0,8).map((t,x)=>e.jsxs(q,{variant:"outline",className:"cursor-pointer hover:bg-accent",onClick:()=>Z(t),children:[ee(t.type),e.jsx("span",{className:"ml-1",children:t.label})]},x))]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-[#3b82f6]"}),e.jsx("span",{className:"text-xs",children:"Court Hearing"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-[#ef4444]"}),e.jsx("span",{className:"text-xs",children:"Medical"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-[#f59e0b]"}),e.jsx("span",{className:"text-xs",children:"Rehabilitation"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-[#8b5cf6]"}),e.jsx("span",{className:"text-xs",children:"Jail Activity/Transfer"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-[#6b7280]"}),e.jsx("span",{className:"text-xs",children:"Other"})]}),i&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"h-3 w-3 rounded-full border-2 border-yellow-600 bg-yellow-400"}),e.jsx("span",{className:"text-xs",children:"Search Match"})]})]}),e.jsx("div",{className:"h-[75vh] w-full rounded-lg border bg-card p-4 shadow-sm",children:e.jsx(Oe,{ref:o,plugins:[$e,Ue,Ge,ut],initialView:"dayGridMonth",headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay listWeek"},height:"100%",selectable:!0,editable:!0,events:w,eventDisplay:"block",eventContent:G,dayCellContent:M,eventTimeFormat:{hour:"2-digit",minute:"2-digit",meridiem:"short",hour12:!0},eventClick:t=>{R({activity_id:t.event.id,title:t.event.title,start:t.event.start,description:t.event.extendedProps.description,pdl:t.event.extendedProps.pdl,pdls:t.event.extendedProps.pdls,pdlNames:t.event.extendedProps.pdlNames,category:t.event.extendedProps.category,status:t.event.extendedProps.status,reason:t.event.extendedProps.reason})},dateClick:he,dayHeaderClassNames:"font-medium",dayCellClassNames:"hover:bg-muted/50 cursor-pointer",nowIndicator:!0,slotMinTime:"06:00:00",slotMaxTime:"20:00:00"})})]}),e.jsx(P,{open:!!u,onOpenChange:()=>R(null),children:e.jsxs(O,{className:"sm:max-w-[600px]",children:[e.jsxs($,{children:[e.jsx(U,{className:"text-2xl",children:u==null?void 0:u.title}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(q,{variant:"outline",className:"border-0 text-white",style:{backgroundColor:B((u==null?void 0:u.category)||"")},children:u==null?void 0:u.category}),e.jsx(q,{variant:"outline",className:"border-0 text-white",style:{backgroundColor:me((u==null?void 0:u.status)||"")},children:u==null?void 0:u.status})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Reason"}),e.jsx("p",{children:(u==null?void 0:u.reason)||"No reason provided"})]})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Date"}),e.jsx("p",{children:(u==null?void 0:u.start)&&E(u.start,"MMMM d, yyyy")})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Time"}),e.jsx("p",{children:(u==null?void 0:u.start)&&E(u.start,"h:mm a")})]})]}),(u==null?void 0:u.pdls)&&u.pdls.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"mb-2 text-sm font-medium text-muted-foreground",children:["Person",u.pdls.length>1?"s":""," Deprived of Liberty"]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:u.pdls.map((t,x)=>e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"â€¢"}),e.jsxs("span",{children:[t.fname," ",t.lname]})]},x))})]})]}),e.jsxs(X,{children:[e.jsx(mt,{event:u}),e.jsx(ht,{event:u})]})]})}),e.jsx(P,{open:z,onOpenChange:n,children:e.jsxs(O,{className:"max-w-2xl",children:[e.jsxs($,{children:[e.jsxs(U,{children:["Add New Event for ",v&&E(new Date(v),"MMMM d, yyyy")]}),e.jsx(Y,{children:"Fill in the details of the event you want to add."})]}),e.jsx(xt,{pdls:a,preselectedDate:v,onSuccess:()=>n(!1)})]})}),e.jsx("style",{children:`
                .highlighted-event {
                    border: 3px solid #f59e0b !important;
                    box-shadow: 0 0 0 2px #f59e0b, 0 4px 6px -1px rgba(0, 0, 0, 0.1) !important;
                    transform: scale(1.02);
                    z-index: 1000;
                }

                .highlighted-date {
                    background: linear-gradient(45deg, #fef3c7, #f59e0b) !important;
                    border-radius: 4px;
                    margin: -2px;
                    padding: 2px;
                }

                .highlighted-date .fc-daygrid-day-number {
                    font-weight: bold;
                    color: #92400e;
                }

                .fc-daygrid-day.highlighted-date-cell {
                    background-color: #fef3c7 !important;
                }
            `})]})}function xt({pdls:s,preselectedDate:a,onSuccess:r}){const[o,i]=p.useState(!1),d=["Court Hearing","Medical","Visitation","Rehabilitation","Jail Activity/Transfer","Other"],f=()=>!l.activity_name||l.activity_name.trim()===""?[]:d.filter(n=>n.toLowerCase().includes(l.activity_name.toLowerCase())),{data:l,setData:c,post:m,processing:b,errors:C,reset:y}=K({activity_name:"",activity_date:a,activity_time:"09:00",category:"",pdl_ids:[]}),N=n=>{n.preventDefault(),m(route("record-officer.jail-events.store"),{preserveScroll:!0,onSuccess:()=>{y(),r()}})},[j,S]=p.useState(""),[w,G]=p.useState(s||[]),[M,u]=p.useState(0),R=()=>{const n=w.map(D=>D.id),v=Array.isArray(l.pdl_ids)?l.pdl_ids:[];n.every(D=>v.includes(D))?c("pdl_ids",v.filter(D=>!n.includes(D))):c("pdl_ids",[...new Set([...v,...n])])};p.useEffect(()=>{G(s.filter(n=>{var v;return`${n.fname} ${n.lname}`.toLowerCase().includes(j.toLowerCase())||((v=n.alias)==null?void 0:v.toLowerCase().includes(j.toLowerCase()))||n.id.toString().includes(j)}))},[j,s]),p.useEffect(()=>{u(Array.isArray(l.pdl_ids)?l.pdl_ids.length:0)},[l.pdl_ids]);const z=n=>{const v=Array.isArray(l.pdl_ids)?l.pdl_ids:[];c("pdl_ids",v.includes(n)?v.filter(D=>D!==n):[...v,n])};return e.jsxs("form",{onSubmit:N,children:[Object.keys(C).length>0&&e.jsxs(Ve,{variant:"destructive",className:"mb-4",children:[e.jsx(qe,{children:"Error"}),e.jsx(We,{children:e.jsx("ul",{className:"list-inside list-disc",children:Object.entries(C).map(([n,v])=>e.jsx("li",{children:v},n))})})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"activity_name",className:"text-sm font-medium",children:"Activity Name"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"activity_name",placeholder:"Type to search activities...",value:l.activity_name,onChange:n=>{c("activity_name",n.target.value),i(n.target.value.trim()!=="")},onFocus:()=>i(l.activity_name.trim()!==""),onBlur:()=>{setTimeout(()=>i(!1),200)},className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",required:!0}),o&&e.jsxs("div",{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md border border-gray-300 bg-white shadow-lg",children:[f().map((n,v)=>e.jsx("div",{className:"cursor-pointer px-3 py-2 text-sm hover:bg-gray-100",onClick:()=>{c("activity_name",n),i(!1)},children:n},v)),f().length===0&&l.activity_name&&e.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No suggestions found"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"activity_date",className:"text-sm font-medium",children:"Event Date"}),e.jsx("input",{type:"date",id:"activity_date",value:l.activity_date,onChange:n=>c("activity_date",n.target.value),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"activity_time",className:"text-sm font-medium",children:"Event Time"}),e.jsx("input",{type:"time",id:"activity_time",value:l.activity_time,onChange:n=>c("activity_time",n.target.value),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"category",className:"text-sm font-medium",children:"Event Category"}),e.jsxs("select",{id:"category",value:l.category,onChange:n=>c("category",n.target.value),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",required:!0,children:[e.jsx("option",{value:"",children:"Select a category"}),e.jsx("option",{value:"court_hearing",children:"Court Hearing"}),e.jsx("option",{value:"jail_activity",children:"Jail Activity"}),e.jsx("option",{value:"medical",children:"Medical"}),e.jsx("option",{value:"visitation",children:"Visitation"}),e.jsx("option",{value:"rehabilitation",children:"Rehabilitation"}),e.jsx("option",{value:"transfer",children:"Transfer"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(L,{children:"Persons Involved (PDLs)"}),e.jsx("button",{type:"button",onClick:R,className:"text-sm text-blue-600 underline hover:text-blue-800",children:w.every(n=>Array.isArray(l.pdl_ids)&&l.pdl_ids.includes(n.id))?"Deselect All":"Select All"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(J,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(I,{placeholder:"Search PDLs by name, alias or ID...",className:"pl-9",value:j,onChange:n=>S(n.target.value)})]}),e.jsx("div",{className:"mt-2 max-h-60 overflow-y-auto rounded-md border",children:w.length===0?e.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"No PDLs found matching your search"}):e.jsx("div",{className:"divide-y",children:w.map(n=>e.jsxs("label",{className:"flex cursor-pointer items-center gap-3 p-3 hover:bg-muted/50",children:[e.jsx(je,{checked:Array.isArray(l.pdl_ids)&&l.pdl_ids.includes(n.id),onCheckedChange:()=>z(n.id)}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[n.fname," ",n.lname,n.alias&&` (${n.alias})`]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["ID: ",n.id," | ",n.age," years | ",n.gender]})]})]},n.id))})}),M>0&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Selected: ",M," PDL(s)"]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>r(),className:"inline-flex h-10 items-center justify-center rounded-md border border-input bg-background px-4 py-2 text-sm font-medium ring-offset-background transition-colors hover:bg-accent hover:text-accent-foreground focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:outline-none disabled:pointer-events-none disabled:opacity-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:b,className:"inline-flex h-10 items-center justify-center rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground ring-offset-background transition-colors hover:bg-primary/90 focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:outline-none disabled:pointer-events-none disabled:opacity-50",children:b?"Creating...":"Create Event"})]})]})}export{Ft as default};
