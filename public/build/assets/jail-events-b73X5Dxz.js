import{m as M,j as e,K as se,r as y,L as ae}from"./app-B_O9F4tw.js";import{D as _,i as W,X as $,a as E,b as A,c as I,d as H,g as L,h as J,C as G,A as re}from"./app-layout-Be9EpAUR.js";import{C as ie}from"./checkbox-B2GzbEB3.js";import{I as R}from"./input-Cch6FJY3.js";import{L as D}from"./label-CZmbwHrp.js";import{D as ne,m as U,g as T,y as u,S as le,V as de,c as P,s as oe,d as ce,f as K,e as me,h as ue,N as he,j as fe,k as B,B as Y,l as xe,n as V,o as ge,_ as X,E as pe,p as Q,q as ve,r as F,t as be,u as ye,v as je,w as k,C as Ne,F as Ce,i as we,a as De,b as Se}from"./create-event-DwNxT-54.js";import{B as w}from"./button-BiD3r4ZK.js";import{T as ke}from"./textarea-dmpnxrHE.js";import{f as C}from"./format-B3rlCQGj.js";import{B as q}from"./badge-D51X8G92.js";import{A as Te,b as _e,a as Ee}from"./alert-rMAx_BHs.js";import{S as Ae}from"./users-DIrrmxra.js";import"./index-D5DTq6I9.js";import"./user-Dmxs8yN8.js";import"./scale-D2Wxh09W.js";import"./eye-CcSNQFx3.js";import"./index-D-eL34-K.js";import"./index-ByUPiVeH.js";import"./index-BCyguBGw.js";import"./index-Iuoe4-tW.js";class Ie extends Y{constructor(){super(...arguments),this.state={textId:T()}}render(){let{theme:a,dateEnv:r,options:d,viewApi:s}=this.context,{cellId:o,dayDate:h,todayRange:n}=this.props,{textId:c}=this.state,m=xe(h,n),f=d.listDayFormat?r.format(h,d.listDayFormat):"",b=d.listDaySideFormat?r.format(h,d.listDaySideFormat):"",p=Object.assign({date:r.toDate(h),view:s,textId:c,text:f,sideText:b,navLinkAttrs:V(this.context,h),sideNavLinkAttrs:V(this.context,h,"day",!1)},m);return u(P,{elTag:"tr",elClasses:["fc-list-day",...ge(m,a)],elAttrs:{"data-date":K(h)},renderProps:p,generatorName:"dayHeaderContent",customGenerator:d.dayHeaderContent,defaultGenerator:Re,classNameGenerator:d.dayHeaderClassNames,didMount:d.dayHeaderDidMount,willUnmount:d.dayHeaderWillUnmount},i=>u("th",{scope:"colgroup",colSpan:3,id:o,"aria-labelledby":c},u(i,{elTag:"div",elClasses:["fc-list-day-cushion",a.getClass("tableCellShaded")]})))}}function Re(t){return u(X,null,t.text&&u("a",Object.assign({id:t.textId,className:"fc-list-day-text"},t.navLinkAttrs),t.text),t.sideText&&u("a",Object.assign({"aria-hidden":!0,className:"fc-list-day-side-text"},t.sideNavLinkAttrs),t.sideText))}const Fe=Q({hour:"numeric",minute:"2-digit",meridiem:"short"});class Me extends Y{render(){let{props:a,context:r}=this,{options:d}=r,{seg:s,timeHeaderId:o,eventHeaderId:h,dateHeaderId:n}=a,c=d.eventTimeFormat||Fe;return u(pe,Object.assign({},a,{elTag:"tr",elClasses:["fc-list-event",s.eventRange.def.url&&"fc-event-forced-url"],defaultGenerator:()=>He(s,r),seg:s,timeText:"",disableDragging:!0,disableResizing:!0}),(m,f)=>u(X,null,Le(s,c,r,o,n),u("td",{"aria-hidden":!0,className:"fc-list-event-graphic"},u("span",{className:"fc-list-event-dot",style:{borderColor:f.borderColor||f.backgroundColor}})),u(m,{elTag:"td",elClasses:["fc-list-event-title"],elAttrs:{headers:`${h} ${n}`}})))}}function He(t,a){let r=be(t,a);return u("a",Object.assign({},r),t.eventRange.def.title)}function Le(t,a,r,d,s){let{options:o}=r;if(o.displayEventTime!==!1){let h=t.eventRange.def,n=t.eventRange.instance,c=!1,m;if(h.allDay?c=!0:ve(t.eventRange.range)?t.isStart?m=F(t,a,r,null,null,n.range.start,t.end):t.isEnd?m=F(t,a,r,null,null,t.start,n.range.end):c=!0:m=F(t,a,r),c){let f={text:r.options.allDayText,view:r.viewApi};return u(P,{elTag:"td",elClasses:["fc-list-event-time"],elAttrs:{headers:`${d} ${s}`},renderProps:f,generatorName:"allDayContent",customGenerator:o.allDayContent,defaultGenerator:Pe,classNameGenerator:o.allDayClassNames,didMount:o.allDayDidMount,willUnmount:o.allDayWillUnmount})}return u("td",{className:"fc-list-event-time"},m)}return null}function Pe(t){return t.text}class Oe extends ne{constructor(){super(...arguments),this.computeDateVars=U(Ge),this.eventStoreToSegs=U(this._eventStoreToSegs),this.state={timeHeaderId:T(),eventHeaderId:T(),dateHeaderIdRoot:T()},this.setRootEl=a=>{a?this.context.registerInteractiveComponent(this,{el:a}):this.context.unregisterInteractiveComponent(this)}}render(){let{props:a,context:r}=this,{dayDates:d,dayRanges:s}=this.computeDateVars(a.dateProfile),o=this.eventStoreToSegs(a.eventStore,a.eventUiBases,s);return u(de,{elRef:this.setRootEl,elClasses:["fc-list",r.theme.getClass("table"),r.options.stickyHeaderDates!==!1?"fc-list-sticky":""],viewSpec:r.viewSpec},u(le,{liquid:!a.isHeightAuto,overflowX:a.isHeightAuto?"visible":"hidden",overflowY:a.isHeightAuto?"visible":"auto"},o.length>0?this.renderSegList(o,d):this.renderEmptyMessage()))}renderEmptyMessage(){let{options:a,viewApi:r}=this.context,d={text:a.noEventsText,view:r};return u(P,{elTag:"div",elClasses:["fc-list-empty"],renderProps:d,generatorName:"noEventsContent",customGenerator:a.noEventsContent,defaultGenerator:$e,classNameGenerator:a.noEventsClassNames,didMount:a.noEventsDidMount,willUnmount:a.noEventsWillUnmount},s=>u(s,{elTag:"div",elClasses:["fc-list-empty-cushion"]}))}renderSegList(a,r){let{theme:d,options:s}=this.context,{timeHeaderId:o,eventHeaderId:h,dateHeaderIdRoot:n}=this.state,c=Ue(a);return u(he,{unit:"day"},(m,f)=>{let b=[];for(let p=0;p<c.length;p+=1){let i=c[p];if(i){let x=K(r[p]),j=n+"-"+x;b.push(u(Ie,{key:x,cellId:j,dayDate:r[p],todayRange:f})),i=me(i,s.eventOrder);for(let v of i)b.push(u(Me,Object.assign({key:x+":"+v.eventRange.instance.instanceId,seg:v,isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:!1,timeHeaderId:o,eventHeaderId:h,dateHeaderId:j},ue(v,f,m))))}}return u("table",{className:"fc-list-table "+d.getClass("table")},u("thead",null,u("tr",null,u("th",{scope:"col",id:o},s.timeHint),u("th",{scope:"col","aria-hidden":!0}),u("th",{scope:"col",id:h},s.eventHint))),u("tbody",null,b))})}_eventStoreToSegs(a,r,d){return this.eventRangesToSegs(oe(a,r,this.props.dateProfile.activeRange,this.context.options.nextDayThreshold).fg,d)}eventRangesToSegs(a,r){let d=[];for(let s of a)d.push(...this.eventRangeToSegs(s,r));return d}eventRangeToSegs(a,r){let{dateEnv:d}=this.context,{nextDayThreshold:s}=this.context.options,o=a.range,h=a.def.allDay,n,c,m,f=[];for(n=0;n<r.length;n+=1)if(c=ce(o,r[n]),c&&(m={component:this,eventRange:a,start:c.start,end:c.end,isStart:a.isStart&&c.start.valueOf()===o.start.valueOf(),isEnd:a.isEnd&&c.end.valueOf()===o.end.valueOf(),dayIndex:n},f.push(m),!m.isEnd&&!h&&n+1<r.length&&o.end<d.add(r[n+1].start,s))){m.end=o.end,m.isEnd=!0;break}return f}}function $e(t){return t.text}function Ge(t){let a=fe(t.renderRange.start),r=t.renderRange.end,d=[],s=[];for(;a<r;)d.push(a),s.push({start:a,end:B(a,1)}),a=B(a,1);return{dayDates:d,dayRanges:s}}function Ue(t){let a=[],r,d;for(r=0;r<t.length;r+=1)d=t[r],(a[d.dayIndex]||(a[d.dayIndex]=[])).push(d);return a}var Be=':root{--fc-list-event-dot-width:10px;--fc-list-event-hover-bg-color:#f5f5f5}.fc-theme-standard .fc-list{border:1px solid var(--fc-border-color)}.fc .fc-list-empty{align-items:center;background-color:var(--fc-neutral-bg-color);display:flex;height:100%;justify-content:center}.fc .fc-list-empty-cushion{margin:5em 0}.fc .fc-list-table{border-style:hidden;width:100%}.fc .fc-list-table tr>*{border-left:0;border-right:0}.fc .fc-list-sticky .fc-list-day>*{background:var(--fc-page-bg-color);position:sticky;top:0}.fc .fc-list-table thead{left:-10000px;position:absolute}.fc .fc-list-table tbody>tr:first-child th{border-top:0}.fc .fc-list-table th{padding:0}.fc .fc-list-day-cushion,.fc .fc-list-table td{padding:8px 14px}.fc .fc-list-day-cushion:after{clear:both;content:"";display:table}.fc-theme-standard .fc-list-day-cushion{background-color:var(--fc-neutral-bg-color)}.fc-direction-ltr .fc-list-day-text,.fc-direction-rtl .fc-list-day-side-text{float:left}.fc-direction-ltr .fc-list-day-side-text,.fc-direction-rtl .fc-list-day-text{float:right}.fc-direction-ltr .fc-list-table .fc-list-event-graphic{padding-right:0}.fc-direction-rtl .fc-list-table .fc-list-event-graphic{padding-left:0}.fc .fc-list-event.fc-event-forced-url{cursor:pointer}.fc .fc-list-event:hover td{background-color:var(--fc-list-event-hover-bg-color)}.fc .fc-list-event-graphic,.fc .fc-list-event-time{white-space:nowrap;width:1px}.fc .fc-list-event-dot{border:calc(var(--fc-list-event-dot-width)/2) solid var(--fc-event-border-color);border-radius:calc(var(--fc-list-event-dot-width)/2);box-sizing:content-box;display:inline-block;height:0;width:0}.fc .fc-list-event-title a{color:inherit;text-decoration:none}.fc .fc-list-event.fc-event-forced-url:hover a{text-decoration:underline}';ye(Be);const Ve={listDayFormat:z,listDaySideFormat:z,noEventsClassNames:k,noEventsContent:k,noEventsDidMount:k,noEventsWillUnmount:k};function z(t){return t===!1?null:Q(t)}var qe=je({name:"@fullcalendar/list",optionRefiners:Ve,views:{list:{component:Oe,buttonTextKey:"list",listDayFormat:{month:"long",day:"numeric",year:"numeric"}},listDay:{type:"list",duration:{days:1},listDayFormat:{weekday:"long"}},listWeek:{type:"list",duration:{weeks:1},listDayFormat:{weekday:"long"},listDaySideFormat:{month:"long",day:"numeric",year:"numeric"}},listMonth:{type:"list",duration:{month:1},listDaySideFormat:{weekday:"long"}},listYear:{type:"list",duration:{year:1},listDaySideFormat:{weekday:"long"}}}});function ze({event:t}){console.log(t);const{data:a,setData:r,patch:d,processing:s,reset:o}=M({activity_id:(t==null?void 0:t.activity_id)||"",reason:"",status:"cancelled"}),h=()=>{d(route("admin.jail-events.cancel"),{preserveScroll:!0,onSuccess:()=>{o()},onError:c=>{console.error("Error canceling event:",c)}})},n=c=>{c||o()};return e.jsxs(_,{onOpenChange:n,children:[e.jsx(W,{asChild:!0,children:e.jsxs(w,{variant:"outline",className:"text-red-600 border-red-200 hover:bg-red-50 hover:text-red-700",children:[e.jsx($,{className:"w-4 h-4 mr-1"}),"Cancel"]})}),e.jsxs(E,{className:"sm:max-w-md",children:[e.jsxs(A,{children:[e.jsxs(I,{className:"text-red-600 flex items-center gap-2",children:[e.jsx($,{className:"w-5 h-5"}),"Cancel Event"]}),e.jsxs(H,{children:["You are about to cancel the event:",e.jsxs("span",{className:"font-semibold text-foreground block mt-1",children:['"',(t==null?void 0:t.title)||"",'"']}),"Please provide a reason for cancellation."]})]}),e.jsx("div",{className:"space-y-4 py-2",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"reason",className:"text-sm font-medium",children:"Reason for Cancellation *"}),e.jsx(R,{id:"reason",value:a.reason,onChange:c=>r("reason",c.target.value),placeholder:"Enter your reason here...",className:"resize-none"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This reason will be recorded with the event cancellation."})]})}),e.jsxs(L,{className:"gap-2 sm:gap-1",children:[e.jsx(J,{asChild:!0,children:e.jsx(w,{variant:"outline",disabled:s,children:"Keep Event"})}),e.jsx(w,{onClick:h,disabled:s||!a.reason.trim(),className:"bg-red-600 hover:bg-red-700 focus:ring-red-600",children:s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Canceling..."]}):"Confirm Cancellation"})]})]})]})}function We({event:t}){const{data:a,setData:r,post:d,processing:s,errors:o,reset:h}=M({activity_id:(t==null?void 0:t.activity_id)||"",date:t!=null&&t.start?C(new Date(t.start),"yyyy-MM-dd"):"",time:t!=null&&t.start?C(new Date(t.start),"HH:mm"):"",reason:"",status:"rescheduled"}),n=()=>{d(route("admin.jail-events.reschedule"),{preserveScroll:!0,onSuccess:()=>{h()},onError:m=>{console.error("Error rescheduling event:",m)}})},c=m=>{m||h()};return e.jsxs(_,{onOpenChange:c,children:[e.jsx(W,{asChild:!0,children:e.jsxs(w,{variant:"outline",children:[e.jsx(G,{className:"h-4 w-4 mr-1"}),"Reschedule"]})}),e.jsxs(E,{className:"sm:max-w-md",children:[e.jsxs(A,{children:[e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5"}),"Reschedule Event"]}),e.jsxs(H,{children:["Update the date, time, and location for:",e.jsxs("span",{className:"font-semibold text-foreground block mt-1",children:['"',(t==null?void 0:t.title)||"",'"']})]})]}),e.jsxs("div",{className:"space-y-4 py-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"date",className:"text-sm font-medium",children:"Date *"}),e.jsx(R,{id:"date",type:"date",value:a.date,onChange:m=>r("date",m.target.value),className:o.date?"border-red-500":""}),o.date&&e.jsx("p",{className:"text-xs text-red-600",children:o.date})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"time",className:"text-sm font-medium",children:"Time *"}),e.jsx(R,{id:"time",type:"time",value:a.time,onChange:m=>r("time",m.target.value),className:o.time?"border-red-500":""}),o.time&&e.jsx("p",{className:"text-xs text-red-600",children:o.time})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"reason",className:"text-sm font-medium",children:"Reason for Rescheduling *"}),e.jsx(ke,{id:"reason",value:a.reason,onChange:m=>r("reason",m.target.value),placeholder:"Explain why this event needs to be rescheduled...",rows:3,className:o.reason?"border-red-500":""}),o.reason&&e.jsx("p",{className:"text-xs text-red-600",children:o.reason}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This reason will be recorded with the event update."})]}),e.jsxs("div",{className:"p-3 bg-muted/50 rounded-md text-sm",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Current Event Details:"}),e.jsxs("div",{className:"space-y-1 text-muted-foreground",children:[e.jsxs("div",{children:["Date: ",t!=null&&t.start?C(new Date(t.start),"MMMM d, yyyy"):"Not set"]}),e.jsxs("div",{children:["Time: ",t!=null&&t.start?C(new Date(t.start),"h:mm a"):"Not set"]})]})]})]}),e.jsxs(L,{className:"gap-2 sm:gap-1",children:[e.jsx(J,{asChild:!0,children:e.jsx(w,{variant:"outline",disabled:s,children:"Cancel"})}),e.jsx(w,{onClick:n,disabled:s||!a.date||!a.time||!a.reason.trim(),className:"bg-blue-600 hover:bg-blue-700",children:s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Updating..."]}):"Reschedule Event"})]})]})]})}const Je=[{title:"Dashboard",href:"/dashboard"}];function gt(){const{props:t}=se(),{pdls:a=[],activities:r=[]}=t,d=r.map(i=>{var j,v;const x=i.pdls?i.pdls.map(S=>`${S.fname} ${S.lname}`).join(", "):i.pdl?`${i.pdl.fname} ${i.pdl.lname}`:"Unknown PDL";return{id:i.activity_id,title:`${i.activity_name} (${((j=i.pdls)==null?void 0:j.length)||1} PDL${(((v=i.pdls)==null?void 0:v.length)||1)>1?"s":""})`,start:`${i.activity_date}T${i.activity_time}`,extendedProps:{description:i.description||"No description provided",pdl:i.pdl,pdls:i.pdls||[],pdlNames:x,category:i.category,reason:i.reason||"No reason provided"},backgroundColor:f(i.category),borderColor:f(i.category),status:i.status,textColor:"#ffffff",className:"hover:shadow-md transition-shadow duration-200"}}),[s,o]=y.useState(null),[h,n]=y.useState(!1),[c,m]=y.useState("");function f(i){switch(i.toLowerCase()){case"court_hearing":case"court hearing":return"#3b82f6";case"medical":return"#ef4444";case"rehabilitation":return"#f59e0b";case"transfer":return"#8b5cf6";case"jail_activity":case"jail activity":return"#8b5cf6";default:return"#6b7280"}}function b(i){switch(i.toLowerCase()){case"pending":return"#f59e0b";case"completed":return"#3b82f6";case"cancelled":return"#ef4444";case"rescheduled":return"#f59e0b";default:return"#6b7280"}}const p=i=>{const x=i.dateStr;m(x),n(!0)};return e.jsxs(re,{breadcrumbs:Je,children:[e.jsx(ae,{title:"Calendar"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 p-4",children:[e.jsxs("div",{className:"flex flex-col justify-between gap-4 md:flex-row md:items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Court Hearings & Jail Activities"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage and view all scheduled activities. Double-click on a date to add a new event."})]}),e.jsx(Ne,{pdls:a})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-[#3b82f6]"}),e.jsx("span",{className:"text-xs",children:"Court Hearing"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-[#ef4444]"}),e.jsx("span",{className:"text-xs",children:"Medical"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-[#f59e0b]"}),e.jsx("span",{className:"text-xs",children:"Rehabilitation"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-[#8b5cf6]"}),e.jsx("span",{className:"text-xs",children:"Jail Activity/Transfer"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-[#6b7280]"}),e.jsx("span",{className:"text-xs",children:"Other"})]})]}),e.jsx("div",{className:"h-[75vh] w-full rounded-lg border bg-card p-4 shadow-sm",children:e.jsx(Ce,{plugins:[we,De,Se,qe],initialView:"dayGridMonth",headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay listWeek"},height:"100%",selectable:!0,editable:!0,events:d,eventDisplay:"block",eventTimeFormat:{hour:"2-digit",minute:"2-digit",meridiem:"short",hour12:!0},eventClick:i=>{o({activity_id:i.event.id,title:i.event.title,start:i.event.start,description:i.event.extendedProps.description,pdl:i.event.extendedProps.pdl,pdls:i.event.extendedProps.pdls,pdlNames:i.event.extendedProps.pdlNames,category:i.event.extendedProps.category,status:i.event.extendedProps.status,reason:i.event.extendedProps.reason})},dateClick:p,dayHeaderClassNames:"font-medium",dayCellClassNames:"hover:bg-muted/50 cursor-pointer",nowIndicator:!0,slotMinTime:"06:00:00",slotMaxTime:"20:00:00"})})]}),e.jsx(_,{open:!!s,onOpenChange:()=>o(null),children:e.jsxs(E,{className:"sm:max-w-[600px]",children:[e.jsxs(A,{children:[e.jsx(I,{className:"text-2xl",children:s==null?void 0:s.title}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(q,{variant:"outline",className:"border-0 text-white",style:{backgroundColor:f((s==null?void 0:s.category)||"")},children:s==null?void 0:s.category}),e.jsx(q,{variant:"outline",className:"border-0 text-white",style:{backgroundColor:b((s==null?void 0:s.status)||"")},children:s==null?void 0:s.status})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Reason"}),e.jsx("p",{children:(s==null?void 0:s.reason)||"No reason provided"})]})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Date"}),e.jsx("p",{children:(s==null?void 0:s.start)&&C(s.start,"MMMM d, yyyy")})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Time"}),e.jsx("p",{children:(s==null?void 0:s.start)&&C(s.start,"h:mm a")})]})]}),(s==null?void 0:s.pdls)&&s.pdls.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"mb-2 text-sm font-medium text-muted-foreground",children:["Person",s.pdls.length>1?"s":""," Deprived of Liberty"]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:s.pdls.map((i,x)=>e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"•"}),e.jsxs("span",{children:[i.fname," ",i.lname]})]},x))})]})]}),e.jsxs(L,{children:[e.jsx(ze,{event:s}),e.jsx(We,{event:s})]})]})}),e.jsx(_,{open:h,onOpenChange:n,children:e.jsxs(E,{className:"max-w-2xl",children:[e.jsxs(A,{children:[e.jsxs(I,{children:["Add New Event for ",c&&C(new Date(c),"MMMM d, yyyy")]}),e.jsx(H,{children:"Fill in the details of the event you want to add."})]}),e.jsx(Ke,{pdls:a,preselectedDate:c,onSuccess:()=>n(!1)})]})})]})}function Ke({pdls:t,preselectedDate:a,onSuccess:r}){const[d,s]=y.useState(!1),o=["Court Hearing","Medical","Visitation","Rehabilitation","Jail Activity/Transfer","Other"],h=()=>!n.activity_name||n.activity_name.trim()===""?[]:o.filter(l=>l.toLowerCase().includes(n.activity_name.toLowerCase())),{data:n,setData:c,post:m,processing:f,errors:b,reset:p}=M({activity_name:"",activity_date:a,activity_time:"09:00",category:"",pdl_ids:[]}),i=l=>{l.preventDefault(),m(route("record-officer.jail-events.store"),{preserveScroll:!0,onSuccess:()=>{p(),r()}})},[x,j]=y.useState(""),[v,S]=y.useState(t||[]),[O,Z]=y.useState(0),ee=()=>{const l=v.map(N=>N.id),g=Array.isArray(n.pdl_ids)?n.pdl_ids:[];l.every(N=>g.includes(N))?c("pdl_ids",g.filter(N=>!l.includes(N))):c("pdl_ids",[...new Set([...g,...l])])};y.useEffect(()=>{S(t.filter(l=>{var g;return`${l.fname} ${l.lname}`.toLowerCase().includes(x.toLowerCase())||((g=l.alias)==null?void 0:g.toLowerCase().includes(x.toLowerCase()))||l.id.toString().includes(x)}))},[x,t]),y.useEffect(()=>{Z(Array.isArray(n.pdl_ids)?n.pdl_ids.length:0)},[n.pdl_ids]);const te=l=>{const g=Array.isArray(n.pdl_ids)?n.pdl_ids:[];c("pdl_ids",g.includes(l)?g.filter(N=>N!==l):[...g,l])};return e.jsxs("form",{onSubmit:i,children:[Object.keys(b).length>0&&e.jsxs(Te,{variant:"destructive",className:"mb-4",children:[e.jsx(_e,{children:"Error"}),e.jsx(Ee,{children:e.jsx("ul",{className:"list-inside list-disc",children:Object.entries(b).map(([l,g])=>e.jsx("li",{children:g},l))})})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"activity_name",className:"text-sm font-medium",children:"Activity Name"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"activity_name",placeholder:"Type to search activities...",value:n.activity_name,onChange:l=>{c("activity_name",l.target.value),s(l.target.value.trim()!=="")},onFocus:()=>s(n.activity_name.trim()!==""),onBlur:()=>{setTimeout(()=>s(!1),200)},className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",required:!0}),d&&e.jsxs("div",{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md border border-gray-300 bg-white shadow-lg",children:[h().map((l,g)=>e.jsx("div",{className:"cursor-pointer px-3 py-2 text-sm hover:bg-gray-100",onClick:()=>{c("activity_name",l),s(!1)},children:l},g)),h().length===0&&n.activity_name&&e.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No suggestions found"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"activity_date",className:"text-sm font-medium",children:"Event Date"}),e.jsx("input",{type:"date",id:"activity_date",value:n.activity_date,onChange:l=>c("activity_date",l.target.value),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"activity_time",className:"text-sm font-medium",children:"Event Time"}),e.jsx("input",{type:"time",id:"activity_time",value:n.activity_time,onChange:l=>c("activity_time",l.target.value),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"category",className:"text-sm font-medium",children:"Event Category"}),e.jsxs("select",{id:"category",value:n.category,onChange:l=>c("category",l.target.value),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",required:!0,children:[e.jsx("option",{value:"",children:"Select a category"}),e.jsx("option",{value:"court_hearing",children:"Court Hearing"}),e.jsx("option",{value:"jail_activity",children:"Jail Activity"}),e.jsx("option",{value:"medical",children:"Medical"}),e.jsx("option",{value:"visitation",children:"Visitation"}),e.jsx("option",{value:"rehabilitation",children:"Rehabilitation"}),e.jsx("option",{value:"transfer",children:"Transfer"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(D,{children:"Persons Involved (PDLs)"}),e.jsx("button",{type:"button",onClick:ee,className:"text-sm text-blue-600 underline hover:text-blue-800",children:v.every(l=>Array.isArray(n.pdl_ids)&&n.pdl_ids.includes(l.id))?"Deselect All":"Select All"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Ae,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(R,{placeholder:"Search PDLs by name, alias or ID...",className:"pl-9",value:x,onChange:l=>j(l.target.value)})]}),e.jsx("div",{className:"mt-2 max-h-60 overflow-y-auto rounded-md border",children:v.length===0?e.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"No PDLs found matching your search"}):e.jsx("div",{className:"divide-y",children:v.map(l=>e.jsxs("label",{className:"flex cursor-pointer items-center gap-3 p-3 hover:bg-muted/50",children:[e.jsx(ie,{checked:Array.isArray(n.pdl_ids)&&n.pdl_ids.includes(l.id),onCheckedChange:()=>te(l.id)}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[l.fname," ",l.lname,l.alias&&` (${l.alias})`]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["ID: ",l.id," | ",l.age," years | ",l.gender]})]})]},l.id))})}),O>0&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Selected: ",O," PDL(s)"]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>r(),className:"inline-flex h-10 items-center justify-center rounded-md border border-input bg-background px-4 py-2 text-sm font-medium ring-offset-background transition-colors hover:bg-accent hover:text-accent-foreground focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:outline-none disabled:pointer-events-none disabled:opacity-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:f,className:"inline-flex h-10 items-center justify-center rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground ring-offset-background transition-colors hover:bg-primary/90 focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:outline-none disabled:pointer-events-none disabled:opacity-50",children:f?"Creating...":"Create Event"})]})]})}export{gt as default};
