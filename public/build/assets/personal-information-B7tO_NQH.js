import{r as v,m as U,K as H,j as e,L as q,$ as G}from"./app-Cw60ViYM.js";import{D as K,i as J,a as Q,b as W,c as X,d as Y,g as Z,A as ee,j as se}from"./app-layout-DcwmIHce.js";import{C as re,a as ae,b as te,c as ne}from"./card-fzSJF6jC.js";import{T as ie,a as ce,b as z,c as n,d as oe,e as i}from"./table-2RhIxSd3.js";import{B as p}from"./button-CmvSvEjs.js";import{A as I,b as M,a as E}from"./alert-o4LoJfEd.js";import{L as le}from"./label-DXzrxJOZ.js";import{T as me}from"./textarea-vzbT_eVm.js";import{V as de}from"./view-pdl-information-B9v_jYXW.js";import{I as he}from"./input-Cov4X3e_.js";import{S as xe,a as ue,b as je,c as fe,d as A,C as ge}from"./select-KJ19SguM.js";import{S as ve}from"./users-HzoBiL24.js";import{f as pe}from"./format-B3rlCQGj.js";import"./index-BPS7Tynv.js";import"./user-DV2uFnOi.js";import"./scale-C_Y39GyJ.js";import"./eye-B-iqHte5.js";import"./index-Bw_Z07or.js";import"./accordion-GkSNsyyL.js";import"./badge-BacZE9yX.js";import"./square-pen-3nx8SzJd.js";import"./radio-group-BF1xGLGO.js";import"./plus-C-DQHveZ.js";import"./custody-management-CSUdOLk3.js";import"./index-3H_A0TGf.js";import"./index-DDJ1Usrt.js";import"./index-C0a4OGu7.js";function Ce({pdl:N}){const[P,j]=v.useState(!1),{data:k,setData:d,post:_,processing:h,errors:b,reset:l}=U({reason:"",pdl_id:N.id}),{props:m}=H(),x=m.success,$=m.error,u=()=>{_(route("pdl-management.transfer",N.id),{preserveScroll:!0,onSuccess:()=>{l(),setTimeout(()=>j(!1),2e3)}})};return e.jsxs(K,{open:P,onOpenChange:j,children:[e.jsx(J,{asChild:!0,children:e.jsx(p,{variant:"ghost",children:"Transfer PDL"})}),e.jsxs(Q,{className:"sm:max-w-md",children:[e.jsxs(W,{children:[e.jsx(X,{children:"Confirm PDL Transfer"}),e.jsxs(Y,{children:["Transfer ",N.full_name," to another facility"]})]}),e.jsxs("div",{className:"space-y-4 py-2",children:[x&&e.jsxs(I,{variant:"success",className:"mb-4",children:[e.jsx(M,{children:"Success"}),e.jsx(E,{children:x})]}),$&&e.jsxs(I,{variant:"destructive",children:[e.jsx(M,{children:"Error"}),e.jsx(E,{children:$})]}),Object.keys(b).length>0&&e.jsxs(I,{variant:"destructive",children:[e.jsx(M,{children:"Error"}),e.jsx(E,{children:e.jsx("ul",{className:"list-inside list-disc",children:Object.values(b).map((o,C)=>e.jsx("li",{children:o},C))})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(le,{htmlFor:"reason",children:"Transfer Reason *"}),e.jsx(me,{id:"reason",value:k.reason,onChange:o=>d("reason",o.target.value),placeholder:"Explain the reason for transfer...",rows:3,required:!0})]}),e.jsx("div",{className:"mt-2 rounded bg-yellow-50 p-4",children:e.jsxs("p",{className:"text-sm text-yellow-700",children:[e.jsx("span",{className:"font-bold",children:"Final Confirmation:"})," This action will immediately initiate the transfer process. Are you sure you want to transfer this PDL?"]})})]}),e.jsxs(Z,{children:[e.jsx(p,{variant:"outline",onClick:()=>j(!1),children:"Cancel"}),e.jsx(p,{type:"button",onClick:u,disabled:h||!k.reason.trim(),className:"bg-red-600 hover:bg-red-700 disabled:opacity-50",children:h?"Processing...":"Confirm Transfer"})]})]})]})}const Ne=[{title:"PDL Management",href:"/pdl-management"}];function Qe(){const{props:N}=H(),{pdls:P}=N,[j,k]=v.useState(""),[d,_]=v.useState("name"),[h,b]=v.useState("asc"),[l,m]=v.useState(1),[x,$]=v.useState(10),u=v.useMemo(()=>{let s=P.filter(r=>{var c,w,y,L,S,D,T;const a=`${(r==null?void 0:r.fname)||""} ${(r==null?void 0:r.mname)||""} ${(r==null?void 0:r.lname)||""}`.toLowerCase(),t=j.toLowerCase();return a.includes(t)||((c=r.alias)==null?void 0:c.toLowerCase().includes(t))||((w=r.gender)==null?void 0:w.toLowerCase().includes(t))||((y=r.ethnic_group)==null?void 0:y.toLowerCase().includes(t))||((L=r.civil_status)==null?void 0:L.toLowerCase().includes(t))||((S=r.brgy)==null?void 0:S.toLowerCase().includes(t))||((D=r.city)==null?void 0:D.toLowerCase().includes(t))||((T=r.province)==null?void 0:T.toLowerCase().includes(t))||r.id.toString().includes(t)});return s.sort((r,a)=>{var w,y,L,S,D,T,V,B,F,O;let t,c;switch(d){case"name":t=`${r.fname} ${r.mname} ${r.lname}`.toLowerCase(),c=`${a.fname} ${a.mname} ${a.lname}`.toLowerCase();break;case"id":t=r.id,c=a.id;break;case"gender":t=((w=r.gender)==null?void 0:w.toLowerCase())||"",c=((y=a.gender)==null?void 0:y.toLowerCase())||"";break;case"ethnic_group":t=((L=r.ethnic_group)==null?void 0:L.toLowerCase())||"",c=((S=a.ethnic_group)==null?void 0:S.toLowerCase())||"";break;case"civil_status":t=((D=r.civil_status)==null?void 0:D.toLowerCase())||"",c=((T=a.civil_status)==null?void 0:T.toLowerCase())||"";break;case"age":t=r.age,c=a.age;break;case"agency":t=((B=(V=r.personnel)==null?void 0:V.agency)==null?void 0:B.toLowerCase())||"",c=((O=(F=a.personnel)==null?void 0:F.agency)==null?void 0:O.toLowerCase())||"";break;default:t=r[d],c=a[d]}return t<c?h==="asc"?-1:1:t>c?h==="asc"?1:-1:0}),s},[P,j,d,h]),o=Math.ceil(u.length/x),C=(l-1)*x,R=u.slice(C,C+x),f=s=>{d===s?b(h==="asc"?"desc":"asc"):(_(s),b("asc")),m(1)},g=({field:s})=>d!==s?null:h==="asc"?e.jsx(ge,{className:"w-4 h-4"}):e.jsx(se,{className:"w-4 h-4"});return e.jsxs(ee,{breadcrumbs:Ne,children:[e.jsx(q,{title:"Personal Information"}),e.jsxs("div",{className:"flex flex-col gap-6 p-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Personal Information"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between items-start sm:items-center",children:[e.jsxs("div",{className:"relative w-full sm:w-64",children:[e.jsx(ve,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(he,{placeholder:"Search PDLs...",value:j,onChange:s=>{k(s.target.value),m(1)},className:"pl-8"})]}),e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Show:"}),e.jsxs(xe,{value:x.toString(),onValueChange:s=>{$(Number(s)),m(1)},children:[e.jsx(ue,{className:"w-20",children:e.jsx(je,{})}),e.jsxs(fe,{children:[e.jsx(A,{value:"10",children:"10"}),e.jsx(A,{value:"25",children:"25"}),e.jsx(A,{value:"50",children:"50"}),e.jsx(A,{value:"100",children:"100"})]})]})]}),e.jsx(G,{href:"/pdl-management/personal-information/create",className:"flex items-center gap-2 rounded-sm bg-blue-500 px-4 py-2 text-sm text-white hover:bg-blue-600",children:"Add PDL Information"})]})]}),e.jsxs(re,{children:[e.jsx(ae,{children:e.jsxs(te,{children:["Personal Information List",e.jsxs("span",{className:"text-sm font-normal text-muted-foreground ml-2",children:["(",u.length," PDL",u.length!==1?"s":"",")"]})]})}),e.jsxs(ne,{children:[e.jsxs(ie,{children:[e.jsx(ce,{children:e.jsxs(z,{children:[e.jsx(n,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>f("id"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["ID",e.jsx(g,{field:"id"})]})}),e.jsx(n,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>f("name"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Full Name",e.jsx(g,{field:"name"})]})}),e.jsx(n,{children:"Alias"}),e.jsx(n,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>f("gender"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Gender",e.jsx(g,{field:"gender"})]})}),e.jsx(n,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>f("ethnic_group"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Ethnic Group",e.jsx(g,{field:"ethnic_group"})]})}),e.jsx(n,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>f("civil_status"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Civil Status",e.jsx(g,{field:"civil_status"})]})}),e.jsx(n,{children:"Date of Birth"}),e.jsx(n,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>f("age"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Age",e.jsx(g,{field:"age"})]})}),e.jsx(n,{children:"Address"}),e.jsx(n,{children:"Encoded By"}),e.jsx(n,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>f("agency"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Agency",e.jsx(g,{field:"agency"})]})}),e.jsx(n,{children:"Transfer Request"}),e.jsx(n,{children:"Archive Status"}),e.jsx(n,{children:"Actions"})]})}),e.jsx(oe,{children:R.map(s=>e.jsxs(z,{children:[e.jsx(i,{children:s.id}),e.jsx(i,{children:`${(s==null?void 0:s.fname)||""}  ${s==null?void 0:s.mname} ${(s==null?void 0:s.lname)||""}`.trim().split(" ").filter(Boolean).map(r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()).join(" ")}),e.jsx(i,{children:s.alias??"-"}),e.jsx(i,{children:s.gender??"-"}),e.jsx(i,{children:s.ethnic_group??"-"}),e.jsx(i,{children:s.civil_status??"-"}),e.jsx(i,{children:pe(new Date(s.birthdate),"MMMM dd, yyyy")}),e.jsx(i,{children:s.age}),e.jsx(i,{children:`${s.brgy??""}, ${s.city??""}, ${s.province??""}`}),e.jsx(i,{children:s.personnel?`${s.personnel.fname} ${s.personnel.lname}`:"—"}),e.jsx(i,{children:s.personnel?`${s.personnel.agency}`:"—"}),e.jsx(i,{children:s.verifications.length>0?s.verifications[0].status.charAt(0).toUpperCase()+s.verifications[0].status.slice(1):"No Verification"}),e.jsx(i,{children:s.archived_at?e.jsx("span",{className:"inline-flex items-center rounded-full bg-red-100 px-2 py-1 text-xs font-medium text-red-800",children:"Archived"}):e.jsx("span",{className:"inline-flex items-center rounded-full bg-green-100 px-2 py-1 text-xs font-medium text-green-800",children:"Active"})}),e.jsx(i,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(de,{pdl:s}),e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>{window.location.href=`/law-enforcement/pdl-management/personal-information/${s.id}`},children:"Edit"}),e.jsx(Ce,{pdl:s})]})})]},s.id))})]}),o>1&&e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",C+1," to ",Math.min(C+x,u.length)," of ",u.length," entries"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{variant:"outline",size:"sm",onClick:()=>m(s=>Math.max(s-1,1)),disabled:l===1,children:"Previous"}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,o)},(s,r)=>{let a;return o<=5||l<=3?a=r+1:l>=o-2?a=o-4+r:a=l-2+r,e.jsx(p,{variant:l===a?"default":"outline",size:"sm",onClick:()=>m(a),children:a},a)})}),e.jsx(p,{variant:"outline",size:"sm",onClick:()=>m(s=>Math.min(s+1,o)),disabled:l===o,children:"Next"})]})]})]})]})]})]})}export{Qe as default};
