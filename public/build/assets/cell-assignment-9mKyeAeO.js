import{j as e,m as f,K as _,r as b,L as S,S as v}from"./app-CzpI4ox_.js";import{D as A}from"./data-table-rX_kU61d.js";import{B as r}from"./button-7HdFF23N.js";import{C as y,a as L,b as N,c as w}from"./card-DCXSBpDZ.js";import{I}from"./index-BitkHseM.js";import{L as x}from"./label-BL2ktVww.js";import{D as K,e as P,a as E,b as M,c as T,d as k,f as q,g as O,A as V}from"./app-layout-DKJQ3ODg.js";import{D as B,a as F,E as H,b as $,c as z,d as g}from"./dropdown-menu-Dhp7spAV.js";import{A as R,a as U,b as G}from"./alert-B9xDvDOq.js";import{S as p,a as j,b as u,c as D,d as C}from"./select-0t9ti-xy.js";import"./table-CgbdoMfa.js";import"./user-BhDnkJWX.js";import"./index-D469PI8o.js";import"./index-CqLSiyF-.js";const J=[{accessorKey:"assignment_id",header:"Assignment ID"},{accessorKey:"cell_number",header:"Cell Number"},{accessorKey:"cell_id",header:"Cell ID"},{accessorKey:"pdl_id",header:"PDL ID"},{accessorKey:"pdl_name",header:"PDL Name"},{accessorKey:"assigned_date",header:"Assigned Date",cell:({row:a})=>new Date(a.original.assigned_date).toLocaleDateString()},{id:"actions",header:"Actions",cell:({row:a})=>{const n=a.original;return e.jsxs(B,{children:[e.jsx(F,{asChild:!0,children:e.jsxs(r,{variant:"ghost",size:"icon",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(H,{className:"h-4 w-4"})]})}),e.jsxs($,{align:"end",children:[e.jsx(z,{children:"Actions"}),e.jsx(g,{onClick:()=>console.log("Edit assignment",n.assignment_id),children:"Edit"}),e.jsx(g,{onClick:()=>console.log("Delete assignment",n.assignment_id),children:"Delete"})]})]})}}];function Q({cells:a,pdls:n}){const{data:t,setData:c,post:m,processing:i,errors:d,reset:h}=f({cell_id:"",pdl_id:""}),o=s=>{s.preventDefault(),m(route("cell-assignments.store"),{preserveScroll:!0,onSuccess:()=>h()})};return e.jsxs(K,{children:[e.jsx(P,{asChild:!0,children:e.jsx(r,{variant:"outline",children:"Assign Cell"})}),e.jsxs(E,{className:"sm:max-w-2xl",children:[e.jsxs(M,{children:[e.jsx(T,{children:"Assign Cell to PDL"}),e.jsx(k,{children:"Select a cell and a PDL to create a new assignment."})]}),e.jsxs("form",{onSubmit:o,className:"mx-auto w-full space-y-4",children:[Object.keys(d).length>0&&e.jsxs(R,{variant:"destructive",className:"mt-4 mb-4",children:[e.jsx(U,{children:"Unable to process request"}),e.jsx(G,{children:e.jsx("ul",{className:"list-inside list-disc text-sm",children:Object.values(d).map((s,l)=>e.jsx("li",{children:s},l))})})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{children:"Cell"}),e.jsxs(p,{value:t.cell_id,onValueChange:s=>c("cell_id",s),required:!0,children:[e.jsx(j,{children:e.jsx(u,{placeholder:"Select a cell"})}),e.jsx(D,{children:a.map(s=>e.jsxs(C,{value:s.cell_id.toString(),children:[s.cell_name," (Capacity: ",s.capacity,")"]},s.cell_id))})]})]}),e.jsxs("div",{children:[e.jsx(x,{children:"PDL (Persons Deprived of Liberty)"}),e.jsxs(p,{value:t.pdl_id,onValueChange:s=>c("pdl_id",s),required:!0,children:[e.jsx(j,{children:e.jsx(u,{placeholder:"Select a PDL"})}),e.jsx(D,{children:n.map(s=>e.jsxs(C,{value:s.id.toString(),children:[s.fname," ",s.lname," (ID: ",s.id,")"]},s.id))})]})]})]}),e.jsxs(q,{children:[e.jsx(r,{type:"submit",disabled:i,children:i?"Assigning...":"Assign Cell"}),e.jsx(O,{asChild:!0,children:e.jsx(r,{variant:"outline",type:"button",children:"Cancel"})})]})]})]})]})}function oe(){const{props:a}=_(),{assignments:n,cells:t,pdls:c,filters:m}=a,[i,d]=b.useState(m.search||""),h=n.map(l=>({assignment_id:l.assignment_id,cell_number:l.cell.cell_name,cell_id:l.cell.cell_id,pdl_id:l.pdl.id,pdl_name:`${l.pdl.fname} ${l.pdl.lname}`,assigned_date:l.created_at})),o=()=>{v.get("/admin/pdl-management/cell-assignment",{search:i})},s=[{title:"Cell Management",href:"/cell-management"},{title:"Assignments",href:"/admin/pdl-management/cell-assignment"}];return e.jsxs(V,{breadcrumbs:s,children:[e.jsx(S,{title:"Cell Assignment Management"}),e.jsxs("div",{className:"flex flex-col gap-6 p-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Cell Assignments"}),e.jsxs(y,{children:[e.jsx(L,{children:e.jsx(N,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Cell Assignment List"}),e.jsx(Q,{cells:t,pdls:c})]})})}),e.jsxs(w,{children:[e.jsxs("div",{className:"mb-4 flex items-center space-x-4",children:[e.jsx(x,{htmlFor:"search",className:"text-sm font-medium",children:"Search Assignments"}),e.jsx(I,{id:"search",placeholder:"Search by cell number or PDL name",className:"w-64",value:i,onChange:l=>d(l.target.value),onKeyDown:l=>l.key==="Enter"&&o()}),e.jsx(r,{variant:"outline",onClick:o,children:"Search"})]}),e.jsx(A,{columns:J,data:h})]})]})]})]})}export{oe as default};
