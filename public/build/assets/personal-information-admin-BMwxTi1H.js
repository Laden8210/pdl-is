import{K as de,r as v,m as E,j as e,L as te,$ as ce}from"./app-CcM30sAC.js";import{A as g,b as C,a as y}from"./alert-CzczWuzi.js";import{B as o}from"./button-nw6-iZy9.js";import{C as ne,a as oe,b as ie,c as he}from"./card-DsmJmjsu.js";import{A as me,D as T,a as I,b as R,c as L,d as F}from"./app-layout-K72RpabK.js";import{I as h}from"./input-DJk89yj0.js";import{L as d}from"./label-BXwUcAO4.js";import{S as $,a as H,b as G,c as q,d as l}from"./select-CyzOf48a.js";import{T as ue,a as pe,b as z,c as t,d as xe,e as c}from"./table-CMhCOYVO.js";import{T as J}from"./textarea-BL1DW8-i.js";import{V as je}from"./view-pdl-information-D-fPhuUH.js";import{g as _e}from"./dateUtils-Iw3XMDmk.js";import{A as ve}from"./archive-Tk1L5QVc.js";import{S as ge}from"./square-pen-Q4FQFoAO.js";import{f as Ce}from"./format-B3rlCQGj.js";import"./index-8Ri7KS3l.js";import"./users-DrCRUVNL.js";import"./user-D8VfSULE.js";import"./scale-BF71mymd.js";import"./eye-gBfh2ZBe.js";import"./index-C4dF5JtL.js";import"./index-B8tX437M.js";import"./index-DBC4w0gw.js";import"./accordion-ChcvJMeN.js";import"./badge-C0fBl2_7.js";import"./file-x-DhAc2eSX.js";import"./radio-group-NOs1kaQU.js";import"./plus-DmWEAzi9.js";const ye=[{title:"PDL Management",href:"/pdl-management"}];function Ke(){var w;const{props:D}=de(),{verifications:x,flash:b}=D;console.log("Verifications:",x);const{auth:N,errors:a}=D,f=((w=N==null?void 0:N.user)==null?void 0:w.position)==="admin",[s,Q]=v.useState(null),[Y,S]=v.useState(!1),[K,O]=v.useState(!1),[W,j]=v.useState(!1),{data:P,setData:A,post:X,processing:k}=E({admission_date:"",release_date:""}),{data:u,setData:m,post:Z,processing:B}=E({court_order_number:"",order_type:"",order_date:"",received_date:"",remarks:"",document_type:"",court_branch:""}),{data:i,setData:p,post:ee,processing:U}=E({archive_status:"",archive_reason:"",archive_court_order_type:"",archive_court_order_file:null}),re=r=>{Q(r),p({archive_status:"",archive_reason:"",archive_court_order_type:"",archive_court_order_file:null}),j(!0)},se=()=>{s&&X(route("pdl.custody-dates",s.id),{onSuccess:()=>{S(!1),A({admission_date:"",release_date:""})},onError:r=>{console.error("Custody dates update errors:",r)}})},ae=()=>{s&&Z(route("pdl.court-order-update",s.id),{onSuccess:()=>{O(!1),m({court_order_number:"",order_type:"",order_date:"",received_date:"",remarks:"",document_type:"",court_branch:""})},onError:r=>{console.error("Court order update errors:",r)}})},le=()=>{s&&(console.log("Submitting archive data:",i),console.log("Selected PDL:",s),console.log("Route URL:",route("pdl.archive",s.id)),ee(route("pdl.archive",s.id),{onSuccess:r=>{console.log("Archive successful",r),p({archive_status:"",archive_reason:"",archive_court_order_type:"",archive_court_order_file:null})},onError:r=>{console.error("Archive errors:",r)},onFinish:()=>{console.log("Archive request finished")}}))},_=D.success;return e.jsxs(me,{breadcrumbs:ye,children:[e.jsx(te,{title:"Personal Information"}),e.jsxs("div",{className:"flex flex-col gap-6 p-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Personal Information"}),e.jsxs(ne,{children:[e.jsx(oe,{children:e.jsx(ie,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Personal Information List"}),e.jsx("div",{className:"flex gap-2",children:!f&&e.jsx(ce,{href:"/pdl-management/personal-information/create",className:"flex items-center gap-2 rounded-sm bg-blue-500 px-4 py-2 text-sm text-white hover:bg-blue-600",children:"Add PDL Information"})})]})})}),e.jsx(he,{children:e.jsxs(ue,{children:[e.jsx(pe,{children:e.jsxs(z,{children:[e.jsx(t,{children:"ID"}),e.jsx(t,{children:"Full Name"}),e.jsx(t,{children:"Alias"}),e.jsx(t,{children:"Gender"}),e.jsx(t,{children:"Ethnic Group"}),e.jsx(t,{children:"Civil Status"}),e.jsx(t,{children:"Date of Birth"}),e.jsx(t,{children:"Age"}),e.jsx(t,{children:"Address"}),e.jsx(t,{children:"Added By"}),e.jsx(t,{children:"Actions"})]})}),e.jsx(xe,{children:x==null?void 0:x.map(r=>{var n,M;return r.pdl&&e.jsxs(z,{children:[e.jsx(c,{children:r.pdl.id}),e.jsx(c,{children:`${((n=r==null?void 0:r.pdl)==null?void 0:n.fname)||""} ${(r==null?void 0:r.pdl.mname)||""}  ${((M=r==null?void 0:r.pdl)==null?void 0:M.lname)||""}`.trim().split(" ").filter(Boolean).map(V=>V.charAt(0).toUpperCase()+V.slice(1).toLowerCase()).join(" ")}),e.jsx(c,{children:r.pdl.alias??"-"}),e.jsx(c,{children:r.pdl.gender??"-"}),e.jsx(c,{children:r.pdl.ethnic_group??"-"}),e.jsx(c,{children:r.pdl.civil_status??"-"}),e.jsx(c,{children:Ce(new Date(r.pdl.birthdate),"MMMM dd, yyyy")}),e.jsx(c,{children:_e(r.pdl.birthdate)}),e.jsx(c,{children:`${r.pdl.brgy??""}, ${r.pdl.city??""}, ${r.pdl.province??""}`}),e.jsx(c,{children:r.pdl.personnel?`${r.pdl.personnel.fname} ${r.pdl.personnel.lname}`:"â€”"}),e.jsxs(c,{className:"space-x-1",children:[e.jsx(je,{pdl:r.pdl}),!f&&e.jsxs(o,{variant:"outline",size:"sm",onClick:()=>re(r.pdl),children:[e.jsx(ve,{className:"mr-1 h-4 w-4"}),"Archive"]}),!f&&e.jsxs(o,{variant:"ghost",size:"sm",onClick:()=>{window.location.href=`/record-officer/pdl-management/personal-information/${r.pdl.id}`},children:[e.jsx(ge,{className:"mr-1 h-4 w-4"}),"Edit"]})]})]},r.pdl.id)})})]})})]}),e.jsx(T,{open:Y,onOpenChange:S,children:e.jsxs(I,{children:[e.jsxs(R,{children:[e.jsx(L,{children:"Manage Custody Dates"}),e.jsxs(F,{children:["Update admission and release dates for ",s==null?void 0:s.fname," ",s==null?void 0:s.lname]})]}),e.jsxs("div",{className:"space-y-4",children:[Object.keys(a).length>0&&e.jsxs(g,{variant:"destructive",className:"mt-4 mb-4",children:[e.jsx(C,{children:"Unable to process request"}),e.jsx(y,{children:Object.values(a).map((r,n)=>e.jsx("ul",{className:"list-inside list-disc text-sm",children:e.jsx("li",{children:r})},n))})]}),_&&e.jsxs(g,{variant:"default",className:"mb-4",children:[e.jsx(C,{children:"Success"}),e.jsx(y,{children:_})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"admission_date",children:"Admission Date"}),e.jsx(h,{id:"admission_date",type:"date",value:P.admission_date,onChange:r=>A("admission_date",r.target.value),className:a!=null&&a.admission_date?"border-red-500":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"release_date",children:"Release Date"}),e.jsx(h,{id:"release_date",type:"date",value:P.release_date,onChange:r=>A("release_date",r.target.value),className:a!=null&&a.release_date?"border-red-500":""})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(o,{variant:"outline",onClick:()=>S(!1),children:"Cancel"}),e.jsx(o,{onClick:se,disabled:k,children:k?"Updating...":"Update Dates"})]})]})]})}),e.jsx(T,{open:K,onOpenChange:O,children:e.jsxs(I,{children:[e.jsxs(R,{children:[e.jsx(L,{children:"Update Court Order"}),e.jsxs(F,{children:["Update court order information for ",s==null?void 0:s.fname," ",s==null?void 0:s.lname]})]}),e.jsxs("div",{className:"space-y-4",children:[Object.keys(a).length>0&&e.jsxs(g,{variant:"destructive",className:"mt-4 mb-4",children:[e.jsx(C,{children:"Unable to process request"}),e.jsx(y,{children:Object.values(a).map((r,n)=>e.jsx("ul",{className:"list-inside list-disc text-sm",children:e.jsx("li",{children:r})},n))})]}),_&&e.jsxs(g,{variant:"default",className:"mb-4",children:[e.jsx(C,{children:"Success"}),e.jsx(y,{children:_})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"court_order_number",children:"Court Order Number"}),e.jsx(h,{id:"court_order_number",value:u.court_order_number,onChange:r=>m("court_order_number",r.target.value),className:a!=null&&a.court_order_number?"border-red-500":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"order_type",children:"Order Type"}),e.jsx(h,{id:"order_type",value:u.order_type,onChange:r=>m("order_type",r.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"order_date",children:"Order Date"}),e.jsx(h,{id:"order_date",type:"date",value:u.order_date,onChange:r=>m("order_date",r.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"received_date",children:"Received Date"}),e.jsx(h,{id:"received_date",type:"date",value:u.received_date,onChange:r=>m("received_date",r.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"court_branch",children:"Court Branch"}),e.jsx(h,{id:"court_branch",value:u.court_branch,onChange:r=>m("court_branch",r.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"remarks",children:"Remarks"}),e.jsx(J,{id:"remarks",value:u.remarks,onChange:r=>m("remarks",r.target.value),rows:3})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(o,{variant:"outline",onClick:()=>O(!1),children:"Cancel"}),e.jsx(o,{onClick:ae,disabled:B,children:B?"Updating...":"Update Court Order"})]})]})]})}),e.jsx(T,{open:W,onOpenChange:j,children:e.jsxs(I,{className:"max-w-2xl",children:[e.jsxs(R,{children:[e.jsx(L,{children:"Archive PDL"}),e.jsxs(F,{children:["Archive ",s==null?void 0:s.fname," ",s==null?void 0:s.lname]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"archive_status",children:"Archive Status *"}),e.jsxs($,{value:i.archive_status,onValueChange:r=>p("archive_status",r),children:[e.jsx(H,{className:a!=null&&a.archive_status?"border-red-500":"",children:e.jsx(G,{placeholder:"Select archive status"})}),e.jsxs(q,{children:[e.jsx(l,{value:"BONDED",children:"BONDED"}),e.jsx(l,{value:"SERVED_SENTENCE",children:"SERVED SENTENCE"}),e.jsx(l,{value:"PROV_DISMISSED",children:"PROV. DISMISSED"}),e.jsx(l,{value:"DISMISSED",children:"DISMISSED"}),e.jsx(l,{value:"TRANSFER_TO_OTHER_FACILITY",children:"TRANSFER TO OTHER FACILITY"}),e.jsx(l,{value:"DAPECOL",children:"DAPECOL"}),e.jsx(l,{value:"PROBATION",children:"PROBATION"}),e.jsx(l,{value:"DECEASED",children:"DECEASED"}),e.jsx(l,{value:"ACQUITTED",children:"ACQUITTED"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"archive_reason",children:"Reason for Archiving *"}),e.jsx(J,{id:"archive_reason",placeholder:"Enter the reason for archiving this PDL record...",value:i.archive_reason,onChange:r=>p("archive_reason",r.target.value),rows:3,className:a!=null&&a.archive_reason?"border-red-500":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"archive_court_order_type",children:"Court Order Type *"}),e.jsxs($,{value:i.archive_court_order_type,onValueChange:r=>p("archive_court_order_type",r),children:[e.jsx(H,{className:a!=null&&a.archive_court_order_type?"border-red-500":"",children:e.jsx(G,{placeholder:"Select court order type"})}),e.jsxs(q,{children:[e.jsx(l,{value:"RELEASE",children:"Release Order"}),e.jsx(l,{value:"BAIL",children:"Bail Order"}),e.jsx(l,{value:"SERVED_SENTENCE",children:"Served Sentence"}),e.jsx(l,{value:"PROBATION",children:"Probation Order"}),e.jsx(l,{value:"PAROLE",children:"Parole Order"}),e.jsx(l,{value:"TRANSFER",children:"Transfer Order"}),e.jsx(l,{value:"OTHER",children:"Other Court Order"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"archive_court_order_file",children:"Court Order Document *"}),e.jsx(h,{id:"archive_court_order_file",type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:r=>{var n;return p("archive_court_order_file",((n=r.target.files)==null?void 0:n[0])||null)},className:a!=null&&a.archive_court_order_file?"border-red-500":""}),e.jsx("p",{className:"text-sm text-gray-500",children:"Upload PDF, JPG, JPEG, or PNG file (max 10MB)"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(o,{variant:"outline",onClick:()=>j(!1),children:"Cancel"}),b!=null&&b.success?e.jsx(o,{onClick:()=>j(!1),children:"Close"}):e.jsx(o,{onClick:le,disabled:U||!i.archive_status||!i.archive_reason||!i.archive_court_order_type||!i.archive_court_order_file,children:U?"Archiving...":"Archive PDL"})]})]})]})})]})]})}export{Ke as default};
