import{m as L,j as e,L as w}from"./app-Cw60ViYM.js";import{B as _}from"./button-CmvSvEjs.js";import{C as r,a as c,b as i,c as n,d as A}from"./card-fzSJF6jC.js";import{L as b}from"./label-DXzrxJOZ.js";import{T as P}from"./textarea-vzbT_eVm.js";import{S,a as T,b as R,c as U,d as B}from"./select-KJ19SguM.js";import{A as m,a as x}from"./alert-o4LoJfEd.js";import{A as k}from"./app-layout-DcwmIHce.js";import{C as y}from"./input-Cov4X3e_.js";import{T as o}from"./triangle-alert-CLrUu-Wq.js";import{U as F}from"./user-DV2uFnOi.js";import{A as $}from"./archive-CJc4N0ug.js";import"./index-Bw_Z07or.js";import"./index-BPS7Tynv.js";import"./index-3H_A0TGf.js";import"./index-DDJ1Usrt.js";import"./index-C0a4OGu7.js";import"./users-HzoBiL24.js";import"./scale-C_Y39GyJ.js";import"./eye-B-iqHte5.js";function ce({pdl:s,archiveStatusOptions:v}){var N,g;const{data:t,setData:u,post:p,processing:d,errors:l}=L({archive_status:s.archive_status||"",archive_reason:s.archive_reason||""}),C=()=>{p(route("pdl.archive",s.id))},D=()=>{p(route("pdl.unarchive",s.id))},h=s.archived_at!==null,f=((N=s.cases)==null?void 0:N.some(a=>a.case_status==="open"||a.case_status==="pending"))||!1;return e.jsxs(k,{children:[e.jsx(w,{title:`Archive PDL - ${s.fname} ${s.lname}`}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"PDL Archive Management"}),e.jsxs("p",{className:"text-muted-foreground",children:["Manage archiving and custody dates for ",s.fname," ",s.lname]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:h?e.jsxs("div",{className:"flex items-center space-x-2 text-green-600",children:[e.jsx(y,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Archived"})]}):e.jsxs("div",{className:"flex items-center space-x-2 text-orange-600",children:[e.jsx(o,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Active"})]})})]}),e.jsxs(r,{children:[e.jsx(c,{children:e.jsx(i,{children:"PDL Information"})}),e.jsx(n,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(F,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"font-medium",children:"Name:"}),e.jsxs("span",{children:[s.fname," ",s.lname]}),s.alias&&e.jsxs("span",{className:"text-muted-foreground",children:["(",s.alias,")"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium",children:"Age:"}),e.jsx("span",{children:s.age||"N/A"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium",children:"Gender:"}),e.jsx("span",{children:s.gender||"N/A"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium",children:"Location:"}),e.jsxs("span",{children:[s.brgy,", ",s.city,", ",s.province]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium",children:"Cases:"}),e.jsx("span",{children:((g=s.cases)==null?void 0:g.length)||0})]}),h&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium",children:"Archived:"}),e.jsx("span",{children:new Date(s.archived_at).toLocaleDateString()})]})]})]})})]}),e.jsxs(r,{children:[e.jsxs(c,{children:[e.jsx(i,{children:"Case Status Information"}),e.jsx(A,{children:"Review case statuses before archiving. PDL can only be archived if all cases are closed, convicted, or deceased."})]}),e.jsx(n,{children:s.cases&&s.cases.length>0?e.jsxs("div",{className:"space-y-3",children:[s.cases.map((a,j)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:a.case_number}),e.jsx("div",{className:"text-sm text-muted-foreground",children:a.crime_committed})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`px-2 py-1 rounded text-sm ${a.case_status==="open"||a.case_status==="pending"?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:a.case_status}),(a.case_status==="open"||a.case_status==="pending")&&e.jsx(o,{className:"h-4 w-4 text-red-500"})]})]},j)),s.cases.some(a=>a.case_status==="open"||a.case_status==="pending")&&e.jsxs(m,{children:[e.jsx(o,{className:"h-4 w-4"}),e.jsx(x,{children:'This PDL cannot be archived because there are open or pending cases. Please update case statuses to "convicted", "deceased", or "case closed" before archiving.'})]})]}):e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"No case information available."})})]}),h&&e.jsxs(r,{children:[e.jsx(c,{children:e.jsx(i,{children:"Archive Information"})}),e.jsx(n,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium",children:"Archive Status:"}),e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-sm",children:v[s.archive_status]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium",children:"Archive Date:"}),e.jsx("span",{children:new Date(s.archived_at).toLocaleString()})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Reason:"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.archive_reason})]}),s.archive_notes&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Notes:"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.archive_notes})]})]})]})})]}),e.jsxs(r,{children:[e.jsxs(c,{children:[e.jsx(i,{children:"Archive Actions"}),e.jsx(A,{children:"Archive or unarchive this PDL record"})]}),e.jsx(n,{children:h?e.jsxs("div",{className:"space-y-4",children:[e.jsxs(m,{children:[e.jsx(o,{className:"h-4 w-4"}),e.jsx(x,{children:"This PDL record is currently archived. You can unarchive it if needed."})]}),e.jsxs(_,{onClick:D,disabled:d,variant:"outline",children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),d?"Unarchiving...":"Unarchive PDL"]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"archive_status",children:"Archive Status *"}),e.jsxs(S,{value:t.archive_status,onValueChange:a=>u("archive_status",a),children:[e.jsx(T,{children:e.jsx(R,{placeholder:"Select archive status"})}),e.jsx(U,{children:Object.entries(v).map(([a,j])=>e.jsx(B,{value:a,children:j},a))})]}),l.archive_status&&e.jsx(m,{children:e.jsx(x,{children:l.archive_status})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"archive_reason",children:"Reason for Archiving *"}),e.jsx(P,{id:"archive_reason",placeholder:"Enter the reason for archiving this PDL record...",value:t.archive_reason,onChange:a=>u("archive_reason",a.target.value),rows:3}),l.archive_reason&&e.jsx(m,{children:e.jsx(x,{children:l.archive_reason})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(_,{onClick:C,disabled:d||!t.archive_status||!t.archive_reason||f,children:[e.jsx($,{className:"h-4 w-4 mr-2"}),d?"Archiving...":"Archive PDL"]}),f&&e.jsx("div",{className:"text-sm text-red-600",children:"Cannot archive: There are open or pending cases that must be resolved first."})]})]})})]}),e.jsxs(r,{children:[e.jsx(c,{children:e.jsx(i,{children:"Archive Requirements"})}),e.jsx(n,{children:e.jsxs("div",{className:"space-y-2 text-sm text-muted-foreground",children:[e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Archive Status:"})," Select the appropriate status from the dropdown"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Reason for Archiving:"})," Provide a detailed reason for archiving this record"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Date and Time:"})," Automatically generated by the system upon archiving"]})]})})]})]})]})}export{ce as default};
