import{r as g,j as e,S as o,K as u,L as y}from"./app-nRThr21f.js";import{D as v}from"./data-table-D4kgLw8d.js";import{C,a as b,b as M,c as k}from"./card-BtWu22vt.js";import{I as S}from"./input-BqM7M9GW.js";import{L as R}from"./label-CQYCAmFm.js";import{D as L,e as P,a as T,b as _,c as A,d as K,f as E,A as I}from"./app-layout-Bl_GOnn5.js";import{B as t}from"./button-PZgMubAt.js";import{D as F,a as $,E as O,b as B,c as H,d as j}from"./dropdown-menu-BN4bZJKE.js";import{T as z}from"./trash-2-137QUfkP.js";import{f as U}from"./format-B3rlCQGj.js";import{A as q,b as G,a as J}from"./alert-lfehfQfo.js";import"./table-DIzpBcrz.js";import"./index-DrcFLKrz.js";import"./users-CDqsdln6.js";import"./user-DyeyardW.js";import"./scale-DOUfLDit.js";import"./eye-D3uxVDSl.js";import"./index-DzeHGQVg.js";import"./index-B02CZ93c.js";import"./index-BXg39buA.js";function Q({record:s}){const[a,c]=g.useState(!1),r=()=>{o.delete(route("medical-records.destroy",s.medical_record_id),{onSuccess:()=>{c(!1)}})};return e.jsxs(L,{open:a,onOpenChange:c,children:[e.jsx(P,{asChild:!0,children:e.jsxs(t,{variant:"ghost",className:"w-full justify-start text-red-500 hover:text-red-700",children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),"Delete"]})}),e.jsxs(T,{className:"sm:max-w-[425px]",children:[e.jsxs(_,{children:[e.jsx(A,{children:"Delete Medical Record"}),e.jsxs(K,{children:["Are you sure you want to delete this medical record?",s.pdl&&e.jsxs("span",{className:"block mt-2 font-medium",children:["PDL: ",s.pdl.fname," ",s.pdl.lname]}),s.complaint&&e.jsxs("span",{className:"block mt-1 text-sm text-gray-600",children:["Complaint: ",s.complaint]}),s.date&&e.jsxs("span",{className:"block mt-1 text-sm text-gray-600",children:["Date: ",new Date(s.date).toLocaleDateString()]}),e.jsx("span",{className:"block mt-2 text-red-600",children:"This action cannot be undone."})]})]}),e.jsxs(E,{children:[e.jsx(t,{variant:"outline",onClick:()=>c(!1),children:"Cancel"}),e.jsx(t,{variant:"destructive",onClick:r,children:"Delete"})]})]})]})}const V=[{accessorKey:"date",header:"Date",cell:({row:s})=>U(new Date(s.original.date),"MMM dd, yyyy")},{id:"pdl",header:"PDL",cell:({row:s})=>{const a=s.original.pdl;return a?`${a.fname} ${a.lname}`:`ID: ${s.original.pdl_id}`}},{accessorKey:"complaint",header:"Complaint",cell:({row:s})=>e.jsx("div",{className:"max-w-[200px] truncate",children:s.original.complaint})},{accessorKey:"findings",header:"Findings",cell:({row:s})=>e.jsx("div",{className:"max-w-[200px] truncate",children:s.original.findings})},{accessorKey:"prognosis",header:"Prognosis",cell:({row:s})=>e.jsx("div",{className:"max-w-[200px] truncate",children:s.original.prognosis})},{accessorKey:"prescription",header:"Prescription",cell:({row:s})=>e.jsx("div",{className:"max-w-[200px] truncate",children:s.original.prescription})},{accessorKey:"stored_filename",header:"Medical Record",cell:({row:s})=>e.jsx("div",{className:"max-w-[200px] truncate",children:e.jsx(t,{variant:"outline",onClick:()=>window.open(`/storage/${s.original.file_path}`,"_blank"),children:"Preview"})})},{id:"actions",header:"Actions",cell:({row:s})=>{const a=s.original;return e.jsxs(F,{children:[e.jsx($,{asChild:!0,children:e.jsxs(t,{variant:"ghost",size:"icon",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(O,{className:"h-4 w-4"})]})}),e.jsxs(B,{align:"end",children:[e.jsx(H,{children:"Actions"}),e.jsx(j,{asChild:!0,children:e.jsx(t,{variant:"ghost",className:"w-full justify-start",onClick:()=>o.visit(route("medical-records.edit",a.medical_record_id)),children:"Edit"})}),e.jsx(j,{asChild:!0,children:e.jsx(Q,{record:a})})]})]})}}],W=[{title:"Medical Records",href:"/medical-records"}];function ge(){const{props:s}=u(),{records:a,pdls:c,filters:r,auth:i,searchPerformed:d,totalResults:l}=s,[m,f]=g.useState((r==null?void 0:r.search)||""),D=()=>{var x;switch((x=i==null?void 0:i.user)==null?void 0:x.position){case"admin":return"/admin/pdl-management/medical-records";case"law-enforcement":return"/law-enforcement/pdl-management/medical-records";case"record-officer":default:return"/record-officer/pdl-management/medical-records"}},h=()=>{o.get(D(),{search:m},{preserveState:!0,replace:!0})},N=n=>{n.key==="Enter"&&h()},{props:w}=u(),p=w.success;return e.jsxs(I,{breadcrumbs:W,children:[e.jsx(y,{title:"Medical Records Management"}),e.jsxs("div",{className:"flex flex-col gap-6 p-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Medical Records"}),e.jsxs(C,{children:[e.jsx(b,{children:e.jsx(M,{children:p&&e.jsxs(q,{variant:"default",children:[e.jsx(G,{children:"Success"}),e.jsx(J,{children:p})]})})}),e.jsxs(k,{children:[e.jsxs("div",{className:"mb-4 flex items-center space-x-4",children:[e.jsx(R,{htmlFor:"search",className:"text-sm font-medium",children:"Search Records"}),e.jsx(S,{id:"search",placeholder:"Search by complaint, PDL name, findings, etc.",className:"w-64 md:w-96",value:m,onChange:n=>f(n.target.value),onKeyDown:N}),e.jsx(t,{variant:"outline",onClick:h,children:"Search"})]}),e.jsx(v,{data:a??[],columns:V}),d&&e.jsx("div",{className:"mt-4 text-center",children:l===0?e.jsxs("div",{className:"text-muted-foreground",children:[e.jsx("p",{className:"text-lg font-medium",children:"No medical records found"}),e.jsxs("p",{className:"mt-2",children:['No medical records match your search criteria: "',r==null?void 0:r.search,'"']}),e.jsx("p",{className:"mt-1 text-sm",children:"Try searching with different keywords or check your spelling."})]}):e.jsx("div",{className:"text-muted-foreground",children:e.jsxs("p",{className:"text-sm",children:["Found ",l," medical record",l!==1?"s":"",' matching "',r==null?void 0:r.search,'"']})})}),!d&&a.length===0&&e.jsxs("div",{className:"mt-4 text-center text-muted-foreground",children:[e.jsx("p",{className:"text-lg font-medium",children:"No medical records found"}),e.jsx("p",{className:"mt-2",children:"Medical records will appear here once they are created."})]})]})]})]})]})}export{ge as default};
