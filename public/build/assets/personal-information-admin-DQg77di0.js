import{K as ae,r as y,m as E,j as e,L as le,$ as ce}from"./app-ChgO15N4.js";import{A as x,b as v,a as j}from"./alert-DovCfj-e.js";import{B as o}from"./button-CLPdctFL.js";import{C as de,a as te,b as ie,c as ne}from"./card-KhZoihPM.js";import{A as oe,D as A,a as T,b as I,c as R,d as F}from"./app-layout-0ITQ75fK.js";import{I as h,a as he}from"./input-B8KEuvEs.js";import{L as c}from"./label-RmhNrkm0.js";import{S as w,a as M,b as V,c as $,d as l}from"./select-66TbGfwa.js";import{T as me,a as ue,b as H,c as d,d as xe,e as t}from"./table-DQ28Xl-Z.js";import{T as q}from"./textarea-BOd3GMW5.js";import{V as je}from"./view-pdl-information-CayZXJ7T.js";import{g as pe}from"./dateUtils-Iw3XMDmk.js";import{A as _e}from"./archive-BFnW6a-R.js";import{S as ve}from"./square-pen-Ci33-hh9.js";import{f as ge}from"./format-B3rlCQGj.js";import"./index-BppsSU27.js";import"./users-C5rTfKHt.js";import"./user-DgjVQXLX.js";import"./scale-C_Wm7gf9.js";import"./eye-BDjgW99s.js";import"./index-D4uwio_V.js";import"./badge-Bo_DDM7g.js";import"./accordion-DH6cMqUK.js";const be=[{title:"PDL Management",href:"/pdl-management"}];function qe(){var U;const{props:C}=ae(),{verifications:g,flash:N}=C;console.log("Verifications:",g);const{auth:f,errors:r}=C,G=((U=f==null?void 0:f.user)==null?void 0:U.position)==="admin",[a,z]=y.useState(null),[J,D]=y.useState(!1),[Q,O]=y.useState(!1),[Y,b]=y.useState(!1),{data:L,setData:S,post:K,processing:k}=E({admission_date:"",release_date:""}),{data:p,setData:m,post:W,processing:P}=E({court_order_number:"",order_type:"",order_date:"",received_date:"",remarks:"",document_type:"",court_branch:""}),{data:i,setData:u,post:X,processing:B}=E({archive_status:"",archive_reason:"",archive_court_order_type:"",archive_court_order_file:null,archive_case_number:""}),Z=s=>{z(s),u({archive_status:"",archive_reason:"",archive_court_order_type:"",archive_court_order_file:null,archive_case_number:""}),b(!0)},ee=()=>{a&&K(route("pdl.custody-dates",a.id),{onSuccess:()=>{D(!1),S({admission_date:"",release_date:""})},onError:s=>{console.error("Custody dates update errors:",s)}})},se=()=>{a&&W(route("pdl.court-order-update",a.id),{onSuccess:()=>{O(!1),m({court_order_number:"",order_type:"",order_date:"",received_date:"",remarks:"",document_type:"",court_branch:""})},onError:s=>{console.error("Court order update errors:",s)}})},re=()=>{a&&(console.log("Submitting archive data:",i),console.log("Selected PDL:",a),console.log("Route URL:",route("pdl.archive",a.id)),X(route("pdl.archive",a.id),{onSuccess:s=>{console.log("Archive successful",s),u({archive_status:"",archive_reason:"",archive_court_order_type:"",archive_court_order_file:null,archive_case_number:""})},onError:s=>{console.error("Archive errors:",s)},onFinish:()=>{console.log("Archive request finished")}}))},_=C.success;return e.jsxs(oe,{breadcrumbs:be,children:[e.jsx(le,{title:"Personal Information"}),e.jsxs("div",{className:"flex flex-col gap-6 p-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Personal Information"}),e.jsxs(de,{children:[e.jsx(te,{children:e.jsx(ie,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Personal Information List"}),e.jsx("div",{className:"flex gap-2",children:e.jsx(ce,{href:"/pdl-management/personal-information/create",className:"flex items-center gap-2 rounded-sm bg-blue-500 px-4 py-2 text-sm text-white hover:bg-blue-600",children:"Add PDL Information"})})]})})}),e.jsx(ne,{children:e.jsxs(me,{children:[e.jsx(ue,{children:e.jsxs(H,{children:[e.jsx(d,{children:"ID"}),e.jsx(d,{children:"Full Name"}),e.jsx(d,{children:"Alias"}),e.jsx(d,{children:"Gender"}),e.jsx(d,{children:"Ethnic Group"}),e.jsx(d,{children:"Civil Status"}),e.jsx(d,{children:"Date of Birth"}),e.jsx(d,{children:"Age"}),e.jsx(d,{children:"Address"}),e.jsx(d,{children:"Added By"}),e.jsx(d,{children:"Actions"})]})}),e.jsx(xe,{children:g==null?void 0:g.map(s=>s.pdl&&e.jsxs(H,{children:[e.jsx(t,{children:s.pdl.id}),e.jsx(t,{children:`${s.pdl.fname} ${s.pdl.lname}`}),e.jsx(t,{children:s.pdl.alias??"-"}),e.jsx(t,{children:s.pdl.gender??"-"}),e.jsx(t,{children:s.pdl.ethnic_group??"-"}),e.jsx(t,{children:s.pdl.civil_status??"-"}),e.jsx(t,{children:ge(new Date(s.pdl.birthdate),"MMMM dd, yyyy")}),e.jsx(t,{children:pe(s.pdl.birthdate)}),e.jsx(t,{children:`${s.pdl.brgy??""}, ${s.pdl.city??""}, ${s.pdl.province??""}`}),e.jsx(t,{children:s.pdl.personnel?`${s.pdl.personnel.fname} ${s.pdl.personnel.lname}`:"â€”"}),e.jsxs(t,{className:"space-x-1",children:[e.jsx(je,{pdl:s.pdl}),e.jsxs(o,{variant:"outline",size:"sm",onClick:()=>Z(s.pdl),children:[e.jsx(_e,{className:"mr-1 h-4 w-4"}),"Archive"]}),!G&&e.jsxs(o,{variant:"ghost",size:"sm",onClick:()=>{window.location.href=`/record-officer/pdl-management/personal-information/${s.pdl.id}`},children:[e.jsx(ve,{className:"mr-1 h-4 w-4"}),"Edit"]})]})]},s.pdl.id))})]})})]}),e.jsx(A,{open:J,onOpenChange:D,children:e.jsxs(T,{children:[e.jsxs(I,{children:[e.jsx(R,{children:"Manage Custody Dates"}),e.jsxs(F,{children:["Update admission and release dates for ",a==null?void 0:a.fname," ",a==null?void 0:a.lname]})]}),e.jsxs("div",{className:"space-y-4",children:[Object.keys(r).length>0&&e.jsxs(x,{variant:"destructive",className:"mt-4 mb-4",children:[e.jsx(v,{children:"Unable to process request"}),e.jsx(j,{children:Object.values(r).map((s,n)=>e.jsx("ul",{className:"list-inside list-disc text-sm",children:e.jsx("li",{children:s})},n))})]}),_&&e.jsxs(x,{variant:"default",className:"mb-4",children:[e.jsx(v,{children:"Success"}),e.jsx(j,{children:_})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"admission_date",children:"Admission Date"}),e.jsx(h,{id:"admission_date",type:"date",value:L.admission_date,onChange:s=>S("admission_date",s.target.value),className:r!=null&&r.admission_date?"border-red-500":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"release_date",children:"Release Date"}),e.jsx(h,{id:"release_date",type:"date",value:L.release_date,onChange:s=>S("release_date",s.target.value),className:r!=null&&r.release_date?"border-red-500":""})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(o,{variant:"outline",onClick:()=>D(!1),children:"Cancel"}),e.jsx(o,{onClick:ee,disabled:k,children:k?"Updating...":"Update Dates"})]})]})]})}),e.jsx(A,{open:Q,onOpenChange:O,children:e.jsxs(T,{children:[e.jsxs(I,{children:[e.jsx(R,{children:"Update Court Order"}),e.jsxs(F,{children:["Update court order information for ",a==null?void 0:a.fname," ",a==null?void 0:a.lname]})]}),e.jsxs("div",{className:"space-y-4",children:[Object.keys(r).length>0&&e.jsxs(x,{variant:"destructive",className:"mt-4 mb-4",children:[e.jsx(v,{children:"Unable to process request"}),e.jsx(j,{children:Object.values(r).map((s,n)=>e.jsx("ul",{className:"list-inside list-disc text-sm",children:e.jsx("li",{children:s})},n))})]}),_&&e.jsxs(x,{variant:"default",className:"mb-4",children:[e.jsx(v,{children:"Success"}),e.jsx(j,{children:_})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"court_order_number",children:"Court Order Number"}),e.jsx(h,{id:"court_order_number",value:p.court_order_number,onChange:s=>m("court_order_number",s.target.value),className:r!=null&&r.court_order_number?"border-red-500":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"order_type",children:"Order Type"}),e.jsx(h,{id:"order_type",value:p.order_type,onChange:s=>m("order_type",s.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"order_date",children:"Order Date"}),e.jsx(h,{id:"order_date",type:"date",value:p.order_date,onChange:s=>m("order_date",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"received_date",children:"Received Date"}),e.jsx(h,{id:"received_date",type:"date",value:p.received_date,onChange:s=>m("received_date",s.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"court_branch",children:"Court Branch"}),e.jsx(h,{id:"court_branch",value:p.court_branch,onChange:s=>m("court_branch",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"remarks",children:"Remarks"}),e.jsx(q,{id:"remarks",value:p.remarks,onChange:s=>m("remarks",s.target.value),rows:3})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(o,{variant:"outline",onClick:()=>O(!1),children:"Cancel"}),e.jsx(o,{onClick:se,disabled:P,children:P?"Updating...":"Update Court Order"})]})]})]})}),e.jsx(A,{open:Y,onOpenChange:b,children:e.jsxs(T,{className:"max-w-2xl",children:[e.jsxs(I,{children:[e.jsx(R,{children:"Archive PDL"}),e.jsxs(F,{children:["Archive ",a==null?void 0:a.fname," ",a==null?void 0:a.lname]})]}),e.jsxs("div",{className:"space-y-4",children:[Object.keys(r).length>0&&e.jsxs(x,{variant:"destructive",className:"mt-4 mb-4",children:[e.jsx(v,{children:"Unable to process request"}),e.jsx(j,{children:Object.values(r).map((s,n)=>e.jsx("ul",{className:"list-inside list-disc text-sm",children:e.jsx("li",{children:s})},n))})]}),_&&e.jsxs(x,{variant:"default",className:"mb-4",children:[e.jsx(v,{children:"Success"}),e.jsx(j,{children:_})]}),Object.keys(r).length>0&&!r.archive_status&&!r.archive_reason&&!r.error&&e.jsxs(x,{className:"border-red-200 bg-red-50",children:[e.jsx(he,{className:"h-4 w-4 text-red-600"}),e.jsx(j,{className:"text-red-800",children:e.jsx("ul",{className:"list-inside list-disc space-y-1",children:Object.entries(r).map(([s,n])=>e.jsx("li",{children:n},s))})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"archive_status",children:"Archive Status *"}),e.jsxs(w,{value:i.archive_status,onValueChange:s=>u("archive_status",s),children:[e.jsx(M,{className:r!=null&&r.archive_status?"border-red-500":"",children:e.jsx(V,{placeholder:"Select archive status"})}),e.jsxs($,{children:[e.jsx(l,{value:"BONDED",children:"BONDED"}),e.jsx(l,{value:"SERVED_SENTENCE",children:"SERVED SENTENCE"}),e.jsx(l,{value:"PROV_DISMISSED",children:"PROV. DISMISSED"}),e.jsx(l,{value:"DISMISSED",children:"DISMISSED"}),e.jsx(l,{value:"TRANSFER_TO_OTHER_FACILITY",children:"TRANSFER TO OTHER FACILITY"}),e.jsx(l,{value:"DAPECOL",children:"DAPECOL"}),e.jsx(l,{value:"PROBATION",children:"PROBATION"}),e.jsx(l,{value:"DECEASED",children:"DECEASED"}),e.jsx(l,{value:"ACQUITTED",children:"ACQUITTED"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"archive_reason",children:"Reason for Archiving *"}),e.jsx(q,{id:"archive_reason",placeholder:"Enter the reason for archiving this PDL record...",value:i.archive_reason,onChange:s=>u("archive_reason",s.target.value),rows:3,className:r!=null&&r.archive_reason?"border-red-500":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"archive_court_order_type",children:"Court Order Type *"}),e.jsxs(w,{value:i.archive_court_order_type,onValueChange:s=>u("archive_court_order_type",s),children:[e.jsx(M,{className:r!=null&&r.archive_court_order_type?"border-red-500":"",children:e.jsx(V,{placeholder:"Select court order type"})}),e.jsxs($,{children:[e.jsx(l,{value:"RELEASE",children:"Release Order"}),e.jsx(l,{value:"BAIL",children:"Bail Order"}),e.jsx(l,{value:"SERVED_SENTENCE",children:"Served Sentence"}),e.jsx(l,{value:"PROBATION",children:"Probation Order"}),e.jsx(l,{value:"PAROLE",children:"Parole Order"}),e.jsx(l,{value:"TRANSFER",children:"Transfer Order"}),e.jsx(l,{value:"OTHER",children:"Other Court Order"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"archive_court_order_file",children:"Court Order Document *"}),e.jsx(h,{id:"archive_court_order_file",type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:s=>{var n;return u("archive_court_order_file",((n=s.target.files)==null?void 0:n[0])||null)},className:r!=null&&r.archive_court_order_file?"border-red-500":""}),e.jsx("p",{className:"text-sm text-gray-500",children:"Upload PDF, JPG, JPEG, or PNG file (max 10MB)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"archive_case_number",children:"Case Number *"}),e.jsx(h,{id:"archive_case_number",placeholder:"Enter case number (must match PDL's case number)",value:i.archive_case_number,onChange:s=>u("archive_case_number",s.target.value),className:r!=null&&r.archive_case_number?"border-red-500":""})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(o,{variant:"outline",onClick:()=>b(!1),children:"Cancel"}),N!=null&&N.success?e.jsx(o,{onClick:()=>b(!1),children:"Close"}):e.jsx(o,{onClick:re,disabled:B||!i.archive_status||!i.archive_reason||!i.archive_court_order_type||!i.archive_court_order_file||!i.archive_case_number,children:B?"Archiving...":"Archive PDL"})]})]})]})})]})]})}export{qe as default};
