import{m as B,r as $,j as e,L as H}from"./app-DLrhnnXh.js";import{B as v}from"./button-HUUzSUz6.js";import{C as x,a as h,b as j,d as _,c as u}from"./card-CXSWsgEw.js";import{L as U}from"./label-BeVFSzwf.js";import{R as k,a as M}from"./radio-group-DvOztSlD.js";import{T as O,a as z,b as w,c as r,d as V,e as n}from"./table-DH4a7d7v.js";import{A as S,a as y}from"./alert-BufgxVdJ.js";import{A as W}from"./app-layout-BHdstRiE.js";import{S as P}from"./shield-CAjDzJaX.js";import{F as Y,B as q}from"./users-CupY9Yjp.js";import{D as J}from"./download-Cg5vPTnC.js";import{U as L}from"./user-BqI6Myw2.js";import{C as p}from"./scale-BW8tIRfq.js";import"./index-BWNjX4Kh.js";import"./input-BmpagesG.js";import"./eye-D815Lj8o.js";function he({certificates:i,filters:d,pdls:T=[]}){var g;const{setData:f,post:R,processing:c}=B({pdl_id:((g=d==null?void 0:d.pdl_ids)==null?void 0:g[0])||null,export_pdf:!1}),[a,G]=$.useState(null),F=s=>{G(s),f("pdl_id",s)},A=(s=!1)=>{f("export_pdf",s),R(route("reports.drug-clearing-certificate.generate"))},E=()=>{const s=new URLSearchParams;a&&s.append("pdl_id",a.toString()),window.location.href=route("reports.drug-clearing-certificate.export")+"?"+s.toString()},l=T.filter(s=>s.cases&&s.cases.some(t=>t.drug_related));return e.jsxs(W,{children:[e.jsx(H,{title:"Drug-Clearing Status Certificate - South Cotabato Rehabilitation and Detention Center"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Drug-Clearing Status Certificate"}),e.jsx("p",{className:"text-muted-foreground",children:"Generate official certificate for drug-clearing status"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{className:"h-5 w-5 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Official Certificate"})]})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(j,{children:"Select PDL for Drug-Clearing Certificate"}),e.jsx(_,{children:"Choose one PDL with drug-related cases to generate certificate"})]}),e.jsx(u,{children:l.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("span",{className:"text-sm font-medium",children:"Select PDL for Certificate Generation"})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(v,{onClick:()=>A(!1),disabled:c||!a,size:"sm",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),c?"Generating...":"Generate Certificate"]}),e.jsxs(v,{onClick:()=>E(),disabled:c||!a,variant:"outline",size:"sm",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Export PDF"]})]})]}),e.jsx("div",{className:"border rounded-lg",children:e.jsxs(O,{children:[e.jsx(z,{children:e.jsxs(w,{children:[e.jsx(r,{className:"w-12",children:"Select"}),e.jsx(r,{children:"Name"}),e.jsx(r,{children:"Commitment Date"}),e.jsx(r,{children:"Drug Cases"}),e.jsx(r,{children:"Detention Period"}),e.jsx(r,{children:"Status"})]})}),e.jsx(V,{children:l.map(s=>{var D;const t=new Date(s.created_at),o=Math.floor((new Date().getTime()-t.getTime())/(1e3*60*60*24)),N=Math.floor(o/365),C=Math.floor(o%365/30),I=o%30,b=((D=s.cases)==null?void 0:D.filter(m=>m.drug_related).length)||0;return e.jsxs(w,{children:[e.jsx(n,{children:e.jsx(k,{value:(a==null?void 0:a.toString())||"",onValueChange:m=>F(parseInt(m)),children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{value:s.id.toString(),id:`pdl-${s.id}`}),e.jsxs(U,{htmlFor:`pdl-${s.id}`,className:"sr-only",children:["Select ",s.first_name," ",s.last_name]})]})})}),e.jsxs(n,{className:"font-medium",children:[s.first_name," ",s.last_name,s.middle_name&&` ${s.middle_name}`]}),e.jsx(n,{children:t.toLocaleDateString()}),e.jsx(n,{children:e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[b," case",b!==1?"s":""]})}),e.jsxs(n,{children:[N>0&&`${N}y `,C>0&&`${C}m `,I,"d"]}),e.jsx(n,{children:e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Active"})})]},s.id)})})]})}),a&&e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"Selected PDL:"}),e.jsx("div",{className:"text-sm text-blue-800",children:(()=>{const s=l.find(t=>t.id===a);return s?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(L,{className:"h-3 w-3"}),e.jsxs("span",{children:[s.first_name," ",s.last_name]})]}):null})()})]})]}):e.jsx(S,{children:e.jsx(y,{children:"No PDLs with drug-related cases found. Please ensure there are PDLs with drug-related cases in the system."})})})]}),i&&i.length>0&&e.jsx("div",{className:"space-y-6",children:e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsxs(j,{children:["Generated Certificates (",i.length,")"]}),e.jsx(_,{children:"Drug-clearing status certificates for selected PDLs"})]}),e.jsx(u,{children:e.jsx("div",{className:"space-y-4",children:i.map((s,t)=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-semibold text-lg",children:s.title}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Certificate #",t+1]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(L,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"font-medium",children:"PDL Name:"}),e.jsx("span",{children:s.pdl.full_name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(p,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"font-medium",children:"Commitment Date:"}),e.jsx("span",{children:s.pdl.commitment_date})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{className:"h-4 w-4 text-purple-600"}),e.jsx("span",{className:"font-medium",children:"Court:"}),e.jsx("span",{children:s.court_info.court})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{className:"font-medium",children:"Charge:"}),e.jsx("span",{children:s.court_info.charge})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(p,{className:"h-4 w-4 text-orange-600"}),e.jsx("span",{className:"font-medium",children:"Case Number:"}),e.jsx("span",{children:s.court_info.case_number})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(p,{className:"h-4 w-4 text-indigo-600"}),e.jsx("span",{className:"font-medium",children:"Issue Date:"}),e.jsx("span",{children:s.issue_date})]})]})]}),e.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded text-xs",children:[e.jsx("div",{className:"font-medium mb-1",children:"Certificate Content:"}),e.jsxs("div",{className:"text-gray-700",children:[e.jsx("strong",{children:"THIS IS TO CERTIFY"})," that ",e.jsx("strong",{children:s.pdl.full_name}),", was committed in this institution on ",e.jsx("strong",{children:s.pdl.commitment_date}),", per Commitment Order issued by the ",s.court_info.court,",",s.court_info.location," for the charge of",e.jsxs("strong",{children:[" ",s.court_info.charge]})," docketed as Criminal Case No. ",s.court_info.case_number,"."]})]})]},s.pdl_id))})})]})}),!i&&e.jsxs(x,{children:[e.jsx(h,{children:e.jsx(j,{children:"Instructions"})}),e.jsx(u,{children:e.jsxs("div",{className:"space-y-2 text-sm text-muted-foreground",children:[e.jsx("p",{children:"• Select one PDL who has drug-related cases"}),e.jsx("p",{children:"• Use radio buttons to select a single PDL"}),e.jsx("p",{children:"• The certificate will show the PDL's detention period and drug-clearing status"}),e.jsx("p",{children:"• Certificate includes court information and case details"}),e.jsx("p",{children:"• Export the certificate as PDF for official documentation"}),e.jsx("p",{children:"• Certificate is signed by the Provincial Warden"})]})})]}),l.length===0&&e.jsx(S,{children:e.jsx(y,{children:"No PDLS with drug-related cases found. Please ensure there are PDLS with drug-related cases in the system."})})]})]})}export{he as default};
