import{K as C,r as _,m as B,j as e,L as I,S as u}from"./app-DViah51f.js";import{A as W,P as z,q as R,r as U,X as O}from"./app-layout-CCA6Jim-.js";import{B as m}from"./button-1m7tU0fB.js";import{C as q,a as G,b as V,c as X}from"./card-Bv9K5Yeq.js";import{I as p}from"./input-B5md_aLw.js";import{L as o}from"./label-CAM58Klf.js";import{S as H,a as J,b as K,c as $,d as Q}from"./select-CBdOQlGP.js";import{T as Y}from"./textarea-C8RWmYDS.js";import{C as Z,a as ee,b as re,c as te,d as se,e as ae,f as de}from"./command-D5KDRVeP.js";import{A as w,b as S,a as D}from"./alert-1rQM27NN.js";import{A as ie}from"./arrow-left-DvdKVQeN.js";import{C as oe}from"./index-CXD71pR2.js";import{F as P}from"./users-CO_wy2-e.js";import{I as ne}from"./image-CvjKfjLW.js";import{E as le}from"./eye-DdWqV9kt.js";import{f as k}from"./format-B3rlCQGj.js";import"./index-DaG-CaTw.js";import"./user-BeiPvLfV.js";import"./scale-GmYhU3cx.js";import"./index-CUgb5ycc.js";import"./index-Bvr9Syq5.js";const ce=[{title:"Court Orders",href:"/pdl-management/court-order"},{title:"Edit Court Order",href:"#"}],me=["Commitment Order","Detention Order","Transfer Order","Release Order","Bail Order","Arrest Warrant","Search Warrant","Subpoena","Court Order","Administrative Order","Medical Order","Visitation Order","Classification Order","Disciplinary Order","Work Assignment Order","Educational Order","Rehabilitation Order","Parole Order","Probation Order","Appeal Order","Motion Order","Hearing Order","Trial Order","Sentencing Order","Execution Order","Others"];function Te(){var b,N;const{props:A}=C(),{order:n,pdls:E}=A,[x,h]=_.useState(!1),[l,c]=_.useState(null),{data:t,setData:i,put:T,processing:j,errors:f}=B({order_type:n.order_type||"",order_date:k(new Date(n.order_date),"yyyy-MM-dd")||"",received_date:k(new Date(n.received_date),"yyyy-MM-dd")||"",document_type:null,court_branch:n.court_branch||"",pdl_id:n.pdl_id.toString(),remarks:n.remarks||""}),{props:F}=C(),g=F.success,L=r=>{i("order_type",r)},y=r=>{const s=new FileReader;r.type.startsWith("image/")?(s.onload=d=>{var a;c((a=d.target)==null?void 0:a.result)},s.readAsDataURL(r)):r.type==="application/pdf"?(s.onload=d=>{var a;c((a=d.target)==null?void 0:a.result)},s.readAsDataURL(r)):r.type==="text/plain"?(s.onload=d=>{var a;c((a=d.target)==null?void 0:a.result)},s.readAsText(r)):r.type.includes("document")||r.name.endsWith(".doc")||r.name.endsWith(".docx")?c("document-file"):c(null)},v=r=>{if(r===0)return"0 Bytes";const s=1024,d=["Bytes","KB","MB","GB"],a=Math.floor(Math.log(r)/Math.log(s));return parseFloat((r/Math.pow(s,a)).toFixed(2))+" "+d[a]},M=r=>{r.preventDefault(),T(route("court-orders.update",n.court_order_id),{preserveScroll:!0,onSuccess:()=>{u.visit(route("pdl-management.court-order"))}})};return e.jsxs(W,{breadcrumbs:ce,children:[e.jsx(I,{title:"Edit Court Order"}),e.jsxs("div",{className:"flex flex-col gap-6 p-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>u.visit(route("pdl-management.court-order")),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Back to Court Orders"]}),e.jsx("h1",{className:"text-2xl font-bold",children:"Edit Court Order"})]}),Object.keys(f).length>0&&e.jsxs(w,{variant:"destructive",children:[e.jsx(S,{children:"Error"}),e.jsx(D,{children:e.jsx("ul",{className:"list-inside list-disc",children:Object.values(f).map((r,s)=>e.jsx("li",{children:r},s))})})]}),g&&e.jsxs(w,{variant:"default",children:[e.jsx(S,{children:"Success"}),e.jsx(D,{children:g})]}),e.jsxs(q,{children:[e.jsx(G,{children:e.jsx(V,{children:"Court Order Details"})}),e.jsx(X,{children:e.jsxs("form",{onSubmit:M,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{htmlFor:"order_type",children:["Order Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(z,{open:x,onOpenChange:h,children:[e.jsx(R,{asChild:!0,children:e.jsxs(m,{variant:"outline",role:"combobox","aria-expanded":x,className:"w-full justify-between",children:[t.order_type||"Select or type order type...",e.jsx(Z,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(U,{className:"w-full p-0",align:"start",children:e.jsxs(ee,{children:[e.jsx(re,{placeholder:"Search order types or type custom...",value:t.order_type,onValueChange:L}),e.jsxs(te,{children:[e.jsx(se,{children:e.jsxs("div",{className:"p-2 text-sm text-muted-foreground",children:['No order type found. Press Enter to add "',t.order_type,'" as custom order type.']})}),e.jsx(ae,{children:me.map(r=>e.jsxs(de,{value:r,onSelect:s=>{i("order_type",s),h(!1)},children:[e.jsx(oe,{className:`mr-2 h-4 w-4 ${t.order_type===r?"opacity-100":"opacity-0"}`}),r]},r))})]})]})})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Select from common order types or type a custom order type"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Order Date"}),e.jsx(p,{type:"date",value:t.order_date,onChange:r=>i("order_date",r.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Received Date"}),e.jsx(p,{type:"date",value:t.received_date,onChange:r=>i("received_date",r.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"document_type",children:"Upload Document"}),e.jsx("input",{type:"file",id:"document_type",name:"document_type",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png,.txt",onChange:r=>{var d;const s=(d=r.target.files)==null?void 0:d[0];s&&(i("document_type",s),y(s))},className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Supported formats: PDF, DOC, DOCX, JPG, JPEG, PNG, TXT"}),l&&e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx(o,{children:"Document Preview"}),e.jsxs("div",{className:"relative",children:[l==="document-file"?e.jsx("div",{className:"flex h-64 w-full items-center justify-center rounded-lg border bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx(P,{className:"mx-auto h-16 w-16 text-gray-400"}),e.jsx("p",{className:"mt-2 text-sm font-medium text-gray-900",children:(b=t.document_type)==null?void 0:b.name}),e.jsx("p",{className:"text-xs text-gray-500",children:"Document file - Preview not available"}),e.jsx("p",{className:"text-xs text-gray-400",children:v(((N=t.document_type)==null?void 0:N.size)||0)})]})}):l.startsWith("data:image/")?e.jsx("img",{src:l,alt:"Document preview",className:"max-h-64 w-full rounded-lg border object-contain"}):l.startsWith("data:application/pdf")?e.jsx("iframe",{src:l,className:"h-64 w-full rounded-lg border",title:"PDF Preview"}):e.jsx("div",{className:"h-64 w-full rounded-lg border bg-white p-4",children:e.jsx("pre",{className:"h-full w-full overflow-auto text-sm text-gray-900 whitespace-pre-wrap",children:l})}),e.jsx(m,{type:"button",variant:"outline",size:"sm",className:"absolute top-2 right-2",onClick:()=>c(null),children:e.jsx(O,{className:"h-4 w-4"})})]})]}),t.document_type&&e.jsx("div",{className:"mt-2 rounded-lg bg-gray-50 p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[t.document_type.type.startsWith("image/")?e.jsx(ne,{className:"h-4 w-4 text-blue-500"}):e.jsx(P,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:t.document_type.name}),e.jsx("p",{className:"text-xs text-gray-500",children:v(t.document_type.size)})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(m,{type:"button",variant:"ghost",size:"sm",onClick:()=>t.document_type&&y(t.document_type),className:"text-blue-500 hover:text-blue-700",title:"Preview file",children:e.jsx(le,{className:"h-4 w-4"})}),e.jsx(m,{type:"button",variant:"ghost",size:"sm",onClick:()=>{i("document_type",null),c(null)},className:"text-red-500 hover:text-red-700",children:e.jsx(O,{className:"h-4 w-4"})})]})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"court_branch",children:"Court Branch"}),e.jsx(p,{id:"court_branch",value:t.court_branch,onChange:r=>i("court_branch",r.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"PDL (Person Deprived of Liberty)"}),e.jsxs(H,{value:t.pdl_id,onValueChange:r=>i("pdl_id",r),required:!0,children:[e.jsx(J,{children:e.jsx(K,{placeholder:"Select a PDL"})}),e.jsx($,{children:E.map(r=>e.jsxs(Q,{value:r.id.toString(),children:[r.fname," ",r.lname," (ID: ",r.id,")"]},r.id))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"remarks",children:"Remarks"}),e.jsx(Y,{id:"remarks",value:t.remarks,onChange:r=>i("remarks",r.target.value),rows:3})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(m,{type:"button",variant:"outline",onClick:()=>u.visit(route("pdl-management.court-order")),children:"Cancel"}),e.jsx(m,{type:"submit",disabled:j,children:j?"Updating...":"Update Order"})]})]})})]})]})]})}export{Te as default};
