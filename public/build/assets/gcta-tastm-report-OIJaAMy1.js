import{K as V,r as x,m as k,j as e,L as E}from"./app-Cw60ViYM.js";import{B as j}from"./button-CmvSvEjs.js";import{C as w,a as L,b as _,c as F}from"./card-fzSJF6jC.js";import{A as H,D as O,a as z,b as K,c as U,g as q,h as J}from"./app-layout-DcwmIHce.js";import{I as g}from"./input-Cov4X3e_.js";import{L as C}from"./label-DXzrxJOZ.js";import{T as Q,a as W,b,c as t,d as X,e as a}from"./table-2RhIxSd3.js";import{t as R,n as $,f as Z}from"./format-B3rlCQGj.js";import"./index-BPS7Tynv.js";import"./users-HzoBiL24.js";import"./user-DV2uFnOi.js";import"./scale-C_Y39GyJ.js";import"./eye-B-iqHte5.js";import"./index-Bw_Z07or.js";function M(r,i){const l=+R(r)-+R(i);return l<0?-1:l>0?1:l}function ee(r,i,l){const[d,n]=$(l==null?void 0:l.in,r,i);return d.getFullYear()-n.getFullYear()}function se(r,i,l){const[d,n]=$(l==null?void 0:l.in,r,i),h=M(d,n),m=Math.abs(ee(d,n));d.setFullYear(1584),n.setFullYear(1584);const u=M(d,n)===-h,o=h*(m-+u);return o===0?0:o}const le=[{title:"Reports",href:"/reports"},{title:"List of PDL",href:"/reports/pdl-list"}];function ae(r){return se(new Date,new Date(r))}function ge(){const{props:r}=V(),{verifications:i}=r,[l,d]=x.useState(""),[n,h]=x.useState(""),[m,u]=x.useState(""),{data:o,get:v}=k({start_date:"",end_date:""}),D=i.filter(s=>{var y,N,A,S;if(!l)return!0;const c=s.pdl;if(!c)return!1;const p=l.toLowerCase();return((y=c.fname)==null?void 0:y.toLowerCase().includes(p))||((N=c.lname)==null?void 0:N.toLowerCase().includes(p))||((A=c.alias)==null?void 0:A.toLowerCase().includes(p))||`${c.fname} ${c.lname}`.toLowerCase().includes(p)||((S=c.id)==null?void 0:S.toString().includes(l))}),G=()=>{const s=new URLSearchParams;s.append("verification_id",(f==null?void 0:f.toString())??""),s.append("full_name",n),s.append("position",m),window.open(route("reports.gcta-tastm.export")+"?"+s.toString(),"_blank")},I=()=>{v(route("reports.gcta-tastm",{start_date:o.start_date,end_date:o.end_date}))},[f,Y]=x.useState(null),[B,T]=x.useState(!1),P=s=>{Y(s),T(!0)};return e.jsxs(H,{breadcrumbs:le,children:[e.jsx(E,{title:"List of PDL Reports"}),e.jsxs("div",{className:"flex flex-col gap-6 p-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h1",{className:"text-2xl font-bold",children:"List of GCTA and TASTM Reports"})}),e.jsxs(w,{children:[e.jsx(L,{children:e.jsx(_,{children:"Filter Reports"})}),e.jsx(F,{children:e.jsxs("div",{className:"mb-4 grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"search",children:"Search"}),e.jsx(g,{id:"search",type:"text",placeholder:"Search by name or ID...",value:l,onChange:s=>d(s.target.value)})]}),e.jsx("div",{className:"flex items-end gap-2 md:col-span-2",children:e.jsx(j,{onClick:I,className:"bg-blue-500 hover:bg-blue-600",children:"Apply Filter"})})]})})]}),e.jsxs(w,{children:[e.jsx(L,{children:e.jsx(_,{className:"text-center",children:e.jsx("div",{className:"mb-4 flex items-center justify-center gap-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-bold",children:"GCTA & TASTM Reports"}),e.jsx("div",{className:"text-sm text-gray-600",children:"South Cotabato Rehabilitation and Detention Center"})]})})})}),e.jsx(F,{children:e.jsxs(Q,{children:[e.jsx(W,{children:e.jsxs(b,{children:[e.jsx(t,{children:"ID"}),e.jsx(t,{children:"Full Name"}),e.jsx(t,{children:"Alias"}),e.jsx(t,{children:"Gender"}),e.jsx(t,{children:"GCTA Days"}),e.jsx(t,{children:"TASTM Days"}),e.jsx(t,{children:"Date of Birth"}),e.jsx(t,{children:"Age"}),e.jsx(t,{children:"Address"}),e.jsx(t,{children:"Added By"}),e.jsx(t,{children:"Actions"})]})}),e.jsx(X,{children:D.length>0?D.map(s=>s.pdl&&e.jsxs(b,{children:[e.jsx(a,{children:s.pdl.id}),e.jsx(a,{children:`${s.pdl.fname} ${s.pdl.lname}`}),e.jsx(a,{children:s.pdl.alias??"-"}),e.jsx(a,{children:s.pdl.gender??"-"}),e.jsx(a,{className:"font-medium",children:s.gcta_days}),e.jsx(a,{className:"font-medium",children:s.tastm_days}),e.jsx(a,{children:Z(new Date(s.pdl.birthdate),"MMMM dd, yyyy")}),e.jsx(a,{children:ae(s.pdl.birthdate)}),e.jsx(a,{children:`${s.pdl.brgy??""}, ${s.pdl.city??""}, ${s.pdl.province??""}`}),e.jsx(a,{children:s.pdl.personnel?`${s.pdl.personnel.fname} ${s.pdl.personnel.lname}`:"â€”"}),e.jsx(a,{className:"space-x-1",children:e.jsx(j,{size:"sm",variant:"outline",onClick:()=>P(s.verification_id),children:"View"})})]},s.pdl.id)):e.jsx(b,{children:e.jsx(a,{colSpan:11,className:"py-4 text-center",children:"No records found"})})})]})})]}),e.jsx(O,{open:B,onOpenChange:T,children:e.jsxs(z,{children:[e.jsx(K,{children:e.jsx(U,{children:"GCTA & TASTM Report"})}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(C,{htmlFor:"full-name",children:"Full Name"}),e.jsx(g,{id:"full-name",type:"text",value:n,onChange:s=>h(s.target.value)})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(C,{htmlFor:"alias",children:"Position"}),e.jsx(g,{id:"position",type:"text",value:m,onChange:s=>u(s.target.value)})]})]}),e.jsxs(q,{children:[e.jsx(J,{asChild:!0,children:e.jsx(j,{variant:"outline",children:"Cancel"})}),e.jsx(j,{onClick:()=>G(),children:"Export"})]})]})})]})]})}export{ge as default};
