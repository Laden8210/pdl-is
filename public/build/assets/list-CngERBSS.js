import{j as e,K as w,m as y,r as g,L as A,S as R}from"./app-DcCWX9mk.js";import{D as C,e as S,a as k,b as D,c as F,d as U,f as q,g as _,A as G}from"./app-layout-CwuzIVoQ.js";import{D as J}from"./data-table-j-gwovtj.js";import{B as m,I as d}from"./index-Cjjgm7p9.js";import{L as i}from"./label-Cwa1UCo1.js";import{A as v,a as f,b as N}from"./alert-CuSR_Jww.js";import{c as L}from"./utils-CRZLC5Gr.js";import{S as O,a as T,b as z,c as I,d as b}from"./select-DZJSQo1m.js";import{C as Q}from"./circle-check-big-BKf4FuBb.js";import{E as K}from"./eye-off-CCxCyiMC.js";import{E as M}from"./eye-Bac0spqN.js";import{L as W}from"./loader-circle-BYvY7VOe.js";import"./users-C5OIh5tf.js";import"./table-CgMGOAID.js";import"./index-C1uMEMb0.js";import"./index-B9NzzXP_.js";import"./index-DlSnFdn1.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],Y=L("Archive",X);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],ee=L("Key",Z);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],ae=L("Pencil",se);function re({page:s,totalPages:l,onPageChange:o}){if(l<=1)return null;const c=Array.from({length:l},(r,t)=>t+1);return e.jsxs("div",{className:"flex flex-wrap justify-center items-center gap-2 mt-4",children:[e.jsx(m,{variant:"outline",size:"sm",onClick:()=>o(s-1),disabled:s===1,children:"Previous"}),c.map(r=>e.jsx(m,{variant:r===s?"default":"outline",size:"sm",onClick:()=>o(r),children:r},r)),e.jsx(m,{variant:"outline",size:"sm",onClick:()=>o(s+1),disabled:s===l,children:"Next"})]})}function te({user:s}){const{props:l}=w(),o=l.success,{delete:c,processing:r,errors:t}=y({}),j=h=>{h.preventDefault(),c(route("user-management.destroy",s.id),{preserveScroll:!0,onSuccess:()=>{}})};return e.jsxs(C,{children:[e.jsx(S,{asChild:!0,children:e.jsxs(m,{onSelect:h=>h.preventDefault(),className:" hover:bg-red-400",variant:"outline",children:[e.jsx(Y,{}),"Archive"]})}),e.jsx(k,{className:"sm:max-w-[425px]",children:e.jsxs("form",{id:"delete-user-form",onSubmit:j,children:[e.jsxs(D,{children:[e.jsx(F,{children:"Delete User"}),e.jsxs(U,{children:["Are you sure you want to archive ",s.fname," ",s.lname,"?"]})]}),Object.keys(t).length>0&&e.jsxs(v,{variant:"destructive",className:"mt-4 mb-4",children:[e.jsx(f,{children:"Unable to process request"}),e.jsx(N,{children:Object.values(t).map((h,x)=>e.jsx("ul",{className:"list-inside list-disc text-sm",children:e.jsx("li",{children:h})},x))})]}),o&&e.jsxs(v,{variant:"default",className:"mb-4",children:[e.jsx(f,{children:"Success"}),e.jsx(N,{children:o})]}),e.jsx("div",{className:"py-4",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"This action cannot be undone. This will permanently delete the user account."})}),e.jsxs(q,{children:[e.jsx(_,{asChild:!0,children:e.jsx(m,{variant:"secondary",children:"Cancel"})}),e.jsx(m,{type:"submit",form:"delete-user-form",variant:"destructive",disabled:r,children:r?"Deleting...":"Delete User"})]})]})})]})}function ne({user:s}){const l=g.useRef(null),{props:o}=w(),c=o.success,{data:r,setData:t,put:j,processing:h,errors:x}=y({firstName:s.fname,middleName:s.mname||"",lastName:s.lname,contactNumber:s.contactnum,avatar:null,username:s.username,password:"",position:s.position,agency:s.agency});g.useEffect(()=>{t({firstName:s.fname,middleName:s.mname||"",lastName:s.lname,contactNumber:s.contactnum,avatar:null,username:s.username,password:"",position:s.position,agency:s.agency})},[s]);const n=a=>{a.preventDefault(),j(route("user-management.update",s.id),{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{t("password","")}})};return e.jsxs(C,{children:[e.jsx(A,{title:"Edit User"}),e.jsx(S,{asChild:!0,children:e.jsxs(m,{variant:"outline",className:"text-start",children:[e.jsx(ae,{}),"Edit"]})}),e.jsx(k,{className:"sm:max-w-3xl",children:e.jsxs("form",{id:"edit-user-form",onSubmit:n,children:[e.jsxs(D,{children:[e.jsx(F,{children:"Edit User"}),e.jsx(U,{children:"Update the user details below."})]}),Object.keys(x).length>0&&e.jsxs(v,{variant:"destructive",className:"mt-4 mb-4",children:[e.jsx(f,{children:"Unable to process request"}),e.jsx(N,{children:Object.values(x).map((a,u)=>e.jsx("ul",{className:"list-inside list-disc text-sm",children:e.jsx("li",{children:a})},u))})]}),c&&e.jsxs(v,{variant:"default",className:"mb-4",children:[e.jsx(f,{children:"Success"}),e.jsx(N,{children:c})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 py-2",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx(i,{htmlFor:"firstName",children:"First Name"}),e.jsx(d,{id:"firstName",name:"firstName",value:r.firstName,onChange:a=>t("firstName",a.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"middleName",children:"Middle Name"}),e.jsx(d,{id:"middleName",name:"middleName",value:r.middleName,onChange:a=>t("middleName",a.target.value)})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(i,{htmlFor:"lastName",children:"Last Name"}),e.jsx(d,{id:"lastName",name:"lastName",value:r.lastName,onChange:a=>t("lastName",a.target.value),required:!0})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(i,{htmlFor:"contactNumber",children:"Contact Number"}),e.jsx(d,{id:"contactNumber",name:"contactNumber",value:r.contactNumber,onChange:a=>t("contactNumber",a.target.value),required:!0})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(i,{htmlFor:"avatar",children:"Avatar"}),e.jsxs("div",{className:"flex items-center gap-4",children:[s.avatar&&e.jsx("img",{src:`/storage/${s.avatar}`,alt:"Current avatar",className:"h-12 w-12 rounded-full object-cover"}),e.jsx(d,{id:"avatar",name:"avatar",type:"file",ref:l,onChange:a=>{var u;return t("avatar",((u=a.target.files)==null?void 0:u[0])??null)},accept:"image/*"})]})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(i,{htmlFor:"username",children:"Username"}),e.jsx(d,{id:"username",name:"username",value:r.username,onChange:a=>t("username",a.target.value),required:!0})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(i,{htmlFor:"password",children:"Password (leave blank to keep current)"}),e.jsx(d,{id:"password",name:"password",type:"password",value:r.password,onChange:a=>t("password",a.target.value),placeholder:"Leave blank to keep current password"})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(i,{htmlFor:"userType",children:"User Type"}),e.jsxs(O,{value:r.position,onValueChange:a=>t("position",a),required:!0,children:[e.jsx(T,{children:e.jsx(z,{placeholder:"Select user type"})}),e.jsxs(I,{children:[e.jsx(b,{value:"law-enforcement",children:"Law Enforcement"}),e.jsx(b,{value:"admin",children:"Administrator"}),e.jsx(b,{value:"record-officer",children:"Records Officer"})]})]})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(i,{htmlFor:"agency",children:"Agency"}),e.jsx(d,{id:"agency",name:"agency",value:r.agency,onChange:a=>t("agency",a.target.value),required:!0})]})]}),e.jsxs(q,{children:[e.jsx(_,{asChild:!0,children:e.jsx(m,{variant:"secondary",children:"Cancel"})}),e.jsx(m,{type:"submit",form:"edit-user-form",className:"bg-blue-500 hover:bg-blue-600",disabled:h,children:h?"Updating...":"Update User"})]})]})})]})}function le({user:s}){const[l,o]=g.useState(!1),[c,r]=g.useState(!1),[t,j]=g.useState(!1),{data:h,setData:x,post:n,processing:a,errors:u,reset:P}=y({password:"",password_confirmation:""}),V=()=>{n(route("user-management.reset-password",{id:s.id}),{onSuccess:()=>{setTimeout(()=>{P()},1500)}})},B=p=>{o(p),p||P()},{props:$}=w(),E=$.success;return e.jsxs(C,{open:l,onOpenChange:B,children:[e.jsx(S,{asChild:!0,children:e.jsxs(m,{variant:"outline",size:"sm",className:"h-8 gap-1",children:[e.jsx(ee,{className:"h-3.5 w-3.5"}),"Reset Password"]})}),e.jsxs(k,{className:"sm:max-w-[425px]",children:[e.jsxs(D,{children:[e.jsx(F,{children:"Reset Password"}),e.jsxs(U,{children:["Set a new password for ",s.fname," ",s.lname," (",s.username,")"]})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[Object.keys(u).length>0&&e.jsxs(v,{variant:"destructive",className:"mb-4",children:[e.jsx(f,{children:"Unable to process request"}),e.jsx(N,{children:Object.values(u).map((p,H)=>e.jsx("ul",{className:"list-inside list-disc text-sm",children:e.jsx("li",{children:p})},H))})]}),E&&e.jsxs(v,{className:"mb-6 border-green-200 bg-green-50/80 backdrop-blur-sm",children:[e.jsx(Q,{className:"h-4 w-4 text-green-600"}),e.jsx(N,{className:"font-medium text-green-800",children:E})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"password",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(d,{id:"password",type:c?"text":"password",value:h.password,onChange:p=>x("password",p.target.value),placeholder:"Enter new password",className:"pr-10",disabled:a}),e.jsx(m,{type:"button",variant:"ghost",size:"sm",className:"absolute top-0 right-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>r(!c),disabled:a,children:c?e.jsx(K,{className:"h-4 w-4"}):e.jsx(M,{className:"h-4 w-4"})})]}),u.password&&e.jsx("p",{className:"text-sm text-destructive",children:u.password})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"password_confirmation",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(d,{id:"password_confirmation",type:t?"text":"password",value:h.password_confirmation,onChange:p=>x("password_confirmation",p.target.value),placeholder:"Confirm new password",className:"pr-10",disabled:a}),e.jsx(m,{type:"button",variant:"ghost",size:"sm",className:"absolute top-0 right-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>j(!t),disabled:a,children:t?e.jsx(K,{className:"h-4 w-4"}):e.jsx(M,{className:"h-4 w-4"})})]}),u.password_confirmation&&e.jsx("p",{className:"text-sm text-destructive",children:u.password_confirmation})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(m,{variant:"outline",onClick:()=>o(!1),disabled:a,children:"Cancel"}),e.jsxs(m,{onClick:V,disabled:a,className:"gap-2",children:[a&&e.jsx(W,{className:"h-4 w-4 animate-spin"}),"Set New Password"]})]})]})]})]})}const ce=[{accessorKey:"fname",header:"First Name"},{accessorKey:"mname",header:"Middle Name",cell:({row:s})=>s.getValue("mname")||e.jsx("span",{className:"text-muted-foreground",children:"N/A"})},{accessorKey:"lname",header:"Last Name"},{accessorKey:"contactnum",header:"Contact No."},{accessorKey:"avatar",header:"Avatar",cell:({row:s})=>{const l=s.getValue("avatar");return l?e.jsx("img",{src:`/storage/${l}`,alt:"Avatar",className:"h-8 w-8 rounded-full object-cover"}):e.jsx("span",{className:"text-muted-foreground",children:"N/A"})}},{accessorKey:"username",header:"Username"},{accessorKey:"position",header:"Position"},{accessorKey:"agency",header:"Agency"},{accessorKey:"password",header:"Request Password Reset",cell:({row:s})=>{const l=s.original;return l.password_resets&&l.password_resets.length>0?e.jsx(le,{user:l}):e.jsx("span",{className:"text-muted-foreground",children:"No active request"})}},{id:"actions",header:"Actions",cell:({row:s})=>{const l=s.original;return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ne,{user:l}),e.jsx(te,{user:l})]})}}];function ie(){const s=g.useRef(null),{props:l}=w(),o=l.success,{data:c,setData:r,post:t,processing:j,errors:h}=y({firstName:"",middleName:"",lastName:"",contactNumber:"",avatar:null,username:"",password:"",position:"",agency:""}),x=n=>{n.preventDefault(),t(route("user-management.store"),{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{r({firstName:"",middleName:"",lastName:"",contactNumber:"",avatar:null,username:"",password:"",position:"",agency:""}),setTimeout(()=>{const a=document.querySelector(".dialog-close-button");a&&a.click()},3e3)}})};return e.jsxs(C,{children:[e.jsx(A,{title:"Create User"}),e.jsx(S,{asChild:!0,children:e.jsx(m,{variant:"outline",children:"Add User"})}),e.jsx(k,{className:"sm:max-w-3xl",children:e.jsxs("form",{id:"create-user-form",onSubmit:x,children:[e.jsxs(D,{children:[e.jsx(F,{children:"Create User"}),e.jsx(U,{children:"Fill in the details to create a new user."})]}),Object.keys(h).length>0&&e.jsxs(v,{variant:"destructive",className:"mb-4 mt-4",children:[e.jsx(f,{children:"Unable to process request"}),e.jsx(N,{children:Object.values(h).map((n,a)=>e.jsx("ul",{className:"list-inside list-disc text-sm",children:e.jsx("li",{children:n})},a))})]}),o&&e.jsxs(v,{variant:"default",className:"mb-4",children:[e.jsx(f,{children:"Success"}),e.jsx(N,{children:o})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 py-2",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx(i,{htmlFor:"firstName",children:"First Name *"}),e.jsx(d,{id:"firstName",name:"firstName",value:c.firstName,onChange:n=>r("firstName",n.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"middleName",children:"Middle Name"}),e.jsx(d,{id:"middleName",name:"middleName",value:c.middleName,onChange:n=>r("middleName",n.target.value)})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(i,{htmlFor:"lastName",children:"Last Name *"}),e.jsx(d,{id:"lastName",name:"lastName",value:c.lastName,onChange:n=>r("lastName",n.target.value),required:!0})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(i,{htmlFor:"contactNumber",children:"Contact Number *"}),e.jsx(d,{id:"contactNumber",name:"contactNumber",value:c.contactNumber,onChange:n=>r("contactNumber",n.target.value),required:!0})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(i,{htmlFor:"avatar",children:"Avatar *"}),e.jsx(d,{id:"avatar",name:"avatar",type:"file",ref:s,onChange:n=>{var a;return r("avatar",((a=n.target.files)==null?void 0:a[0])??null)},accept:"image/*"})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(i,{htmlFor:"username",children:"Username *"}),e.jsx(d,{id:"username",name:"username",value:c.username,onChange:n=>r("username",n.target.value),required:!0})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(i,{htmlFor:"password",children:"Password *"}),e.jsx(d,{id:"password",name:"password",type:"password",value:c.password,onChange:n=>r("password",n.target.value),required:!0})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(i,{htmlFor:"userType",children:"User Type *"}),e.jsxs(O,{value:c.position,onValueChange:n=>r("position",n),required:!0,children:[e.jsx(T,{children:e.jsx(z,{placeholder:"Select user type"})}),e.jsxs(I,{children:[e.jsx(b,{value:"law-enforcement",children:"Law Enforcement"}),e.jsx(b,{value:"admin",children:"Administrator"}),e.jsx(b,{value:"record-officer",children:"Records Officer"})]})]})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(i,{htmlFor:"agency",children:"Agency *    "}),e.jsx(d,{id:"agency",name:"agency",value:c.agency,onChange:n=>r("agency",n.target.value),required:!0})]})]}),e.jsxs(q,{children:[e.jsx(_,{asChild:!0,children:e.jsx(m,{variant:"secondary",children:"Cancel"})}),e.jsx(m,{type:"submit",form:"create-user-form",className:"bg-blue-500 hover:bg-blue-600",disabled:j,children:j?"Creating...":"Create User"})]})]})})]})}const de=[{title:"Dashboard",href:"/dashboard"}];function De(){const{users:s,filters:l}=w().props,[o,c]=g.useState(l.search||""),r=()=>{R.get("/admin/user-management",{search:o},{preserveState:!0})};return e.jsxs(G,{breadcrumbs:de,children:[e.jsx(A,{title:"User Management"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"User Management"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage your users and their permissions."})]}),e.jsx(ie,{})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(i,{htmlFor:"search",className:"text-sm font-medium",children:"Search Users"}),e.jsx(d,{id:"search",placeholder:"Search by name or username",className:"w-64",value:o,onChange:t=>c(t.target.value),onKeyDown:t=>t.key==="Enter"&&r()}),e.jsx(m,{variant:"outline",onClick:r,children:"Search"})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(J,{columns:ce,data:s.data}),e.jsx(re,{page:s.current_page,totalPages:s.last_page,onPageChange:t=>R.get("/admin/user-management",{search:l.search,page:t},{preserveState:!0})})]})]})]})}export{De as default};
